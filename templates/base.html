<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="{% block meta_description %}CodeXam - Elite Coding Arena. The hardcore coding challenge engine for serious developers.{% endblock %}">
    <meta name="keywords" content="coding, programming, challenges, algorithms, interview prep, python, javascript, java, c++">
    <meta name="author" content="CodeXam">
    
    <!-- Open Graph / Social Media -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="{% block og_title %}CodeXam - Elite Coding Arena{% endblock %}">
    <meta property="og:description" content="{% block og_description %}Master algorithms, dominate interviews, and prove your skills in the digital battleground.{% endblock %}">
    <meta property="og:image" content="{{ url_for('static', filename='img/og-image.png') }}">
    
    <!-- Theme Colors -->
    <meta name="theme-color" content="#00ff88">
    <meta name="msapplication-TileColor" content="#0a0a0a">
    
    <title>{% block title %}CodeXam - Elite Coding Arena{% endblock %}</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='img/favicon.ico') }}">
    <link rel="apple-touch-icon" href="{{ url_for('static', filename='img/apple-touch-icon.png') }}">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Critical CSS (Inline for faster loading) -->
    <style>
      /* Critical above-the-fold styles only */
      body { background: var(--bg-primary); color: var(--text-primary); }
      .cyber-navbar { background: var(--bg-secondary); border-bottom: 1px solid var(--border-primary); }
      .main-content { min-height: calc(100vh - 200px); }
    </style>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Custom CSS (Load optimized versions when available) -->
    {% if config.ENV == 'production' %}
      <link href="{{ url_for('static', filename='optimized/style.min.css') }}" rel="stylesheet">
      <link href="{{ url_for('static', filename='optimized/clean-nav.min.css') }}" rel="stylesheet">
    {% else %}
      <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">
      <link href="{{ url_for('static', filename='css/clean-nav.css') }}" rel="stylesheet">
    {% endif %}
    <link href="{{ url_for('static', filename='css/system-info-modal.css') }}" rel="stylesheet">
    
    {% block extra_css %}{% endblock %}
  </head>
<  <body class="{% block body_class %}{% endblock %}">
    <!-- Skip link for accessibility -->
    <a href="#main-content" class="skip-link">Skip to main content</a>
    
    <!-- Main Navigation -->
    <nav class="cyber-navbar" role="navigation" aria-label="Main navigation">
      <div class="navbar-container">
        <!-- Brand Section (Terminal Style) -->
        <div class="navbar-brand">
          <a href="{{ url_for('index') }}" class="brand-link" aria-label="CodeXam Home">
            <span class="brand-icon">&lt;/&gt;</span>
            <span class="brand-text" data-text="CodeXam">CodeXam</span>
            <span class="brand-status animate-pulse">‚óè</span>
          </a>
        </div>
        
        <!-- Mobile Menu Toggle -->
        <button class="navbar-toggle d-lg-none" 
                type="button" 
                aria-label="Toggle navigation menu" 
                aria-expanded="false"
                data-bs-toggle="collapse" 
                data-bs-target="#navbarNav">
          <span class="hamburger-line"></span>
          <span class="hamburger-line"></span>
          <span class="hamburger-line"></span>
        </button>
        
        <!-- Navigation Links (Cyber Style) -->
        <div class="navbar-nav collapse navbar-collapse" id="navbarNav">
          <a href="{{ url_for('problems_list') }}" 
             class="nav-link {% if request.endpoint == 'problems_list' %}active{% endif %}" 
             data-text="Problems"
             aria-current="{% if request.endpoint == 'problems_list' %}page{% endif %}">
            <span class="nav-icon" aria-hidden="true">‚ö°</span>
            <span>Problems</span>
          </a>
          
          {% if session.user_name and session.user_name != 'Anonymous' %}
            <a href="{{ url_for('submissions_history') }}" 
               class="nav-link {% if request.endpoint == 'submissions_history' %}active{% endif %}" 
               data-text="Submissions"
               aria-current="{% if request.endpoint == 'submissions_history' %}page{% endif %}">
              <span class="nav-icon" aria-hidden="true">üìä</span>
              <span>Submissions</span>
            </a>
          {% endif %}
          
          <a href="{{ url_for('leaderboard') }}" 
             class="nav-link {% if request.endpoint == 'leaderboard' %}active{% endif %}" 
             data-text="Leaderboard"
             aria-current="{% if request.endpoint == 'leaderboard' %}page{% endif %}">
            <span class="nav-icon" aria-hidden="true">üèÜ</span>
            <span>Leaderboard</span>
          </a>
          
          <!-- Admin Link -->
          <a href="{{ url_for('admin_panel') }}" 
             class="nav-link {% if request.endpoint == 'admin_panel' %}active{% endif %}" 
             data-text="Admin"
             aria-current="{% if request.endpoint == 'admin_panel' %}page{% endif %}">
            <span class="nav-icon" aria-hidden="true">‚öôÔ∏è</span>
            <span>Admin</span>
          </a>
        </div>
            
            <!-- User Section (Enhanced Hacker Style) -->
            <div class="navbar-user">
                {% if session.user_name %}
                    <!-- Hacker-Style User Profile (Named or Anonymous) -->
                    <div class="user-profile-dropdown">
                        <button class="user-profile-btn" 
                                type="button" 
                                data-bs-toggle="dropdown" 
                                aria-expanded="false"
                                aria-label="User menu">
                            <div class="user-avatar-hacker">
                                {{ session.user_name[0].upper() }}
                            </div>
                            <div class="user-info-hacker">
                                <span class="user-name-hacker">{{ session.user_name }}</span>
                                <span class="user-status-hacker">
                                    <span class="status-dot-hacker animate-pulse"></span>
                                    <span class="status-text">ONLINE</span>
                                </span>
                            </div>
                            <svg class="dropdown-chevron" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </button>
                        
                        <ul class="dropdown-menu user-menu-hacker">
                            <li class="menu-header">
                                <div class="user-profile-header">
                                    <div class="user-avatar-large-hacker">
                                        {{ session.user_name[0].upper() }}
                                    </div>
                                    <div class="user-details-hacker">
                                        <div class="user-name-large-hacker">{{ session.user_name }}</div>
                                        <div class="user-role-hacker">
                                            {% if session.user_name == 'Anonymous' %}
                                                GHOST_MODE
                                            {% else %}
                                                ELITE_CODER
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                            </li>
                            <li><hr class="menu-divider"></li>
                            {% if session.user_name != 'Anonymous' %}
                            <li>
                                <a class="menu-item" href="{{ url_for('submissions_history') }}">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                                        <polyline points="14,2 14,8 20,8"/>
                                        <line x1="16" y1="13" x2="8" y2="13"/>
                                        <line x1="16" y1="17" x2="8" y2="17"/>
                                    </svg>
                                    <span>My_Submissions()</span>
                                </a>
                            </li>
                            {% endif %}
                            <li>
                                <button class="menu-item" 
                                        data-bs-toggle="modal" 
                                        data-bs-target="#changeNameModal">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                                        <circle cx="12" cy="7" r="4"/>
                                    </svg>
                                    <span>{% if session.user_name == 'Anonymous' %}Set_Identity(){% else %}Change_Identity(){% endif %}</span>
                                </button>
                            </li>
                            <li>
                                <button class="menu-item" onclick="CodeXamUI.showKeyboardShortcuts()">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <rect x="2" y="3" width="20" height="14" rx="2" ry="2"/>
                                        <line x1="8" y1="21" x2="16" y2="21"/>
                                        <line x1="12" y1="17" x2="12" y2="21"/>
                                    </svg>
                                    <span>Shortcuts_Help()</span>
                                </button>
                            </li>
                            <li><hr class="menu-divider"></li>
                            <li>
                                <a class="menu-item" href="{{ url_for('logout') }}">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
                                        <polyline points="16 17 21 12 16 7"/>
                                        <line x1="21" y1="12" x2="9" y2="12"/>
                                    </svg>
                                    <span>Terminate_Session()</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                {% else %}
                    <!-- Anonymous User - Hacker Style -->
                    <button class="btn-hacker-enter" 
                            data-bs-toggle="modal" 
                            data-bs-target="#setNameModal">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"/>
                            <polyline points="10 17 15 12 10 7"/>
                            <line x1="15" y1="12" x2="3" y2="12"/>
                        </svg>
                        <span>AUTHENTICATE_USER()</span>
                    </button>
                {% endif %}
            </div>
        </div>
    </nav>

    <!-- Flash Messages -->
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <div class="container mt-3" role="region" aria-label="Status messages">
          {% for category, message in messages %}
            <div class="alert alert-{{ 'danger' if category == 'error' else category }} alert-dismissible fade show animate-slide-up" 
                 role="alert"
                 aria-live="polite"
                 aria-atomic="true">
              <div class="d-flex align-items-center">
                {% if category == 'success' %}
                  <span class="me-2" aria-hidden="true">‚úÖ</span>
                {% elif category == 'error' %}
                  <span class="me-2" aria-hidden="true">‚ùå</span>
                {% elif category == 'warning' %}
                  <span class="me-2" aria-hidden="true">‚ö†Ô∏è</span>
                {% else %}
                  <span class="me-2" aria-hidden="true">‚ÑπÔ∏è</span>
                {% endif %}
                <span class="visually-hidden">{{ category|title }}:</span>
                {{ message }}
              </div>
              <button type="button" 
                      class="btn-close" 
                      data-bs-dismiss="alert" 
                      aria-label="Close {{ category }} message">
              </button>
            </div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}



    <!-- Main Content -->
    <main id="main-content" class="main-content" role="main">
      {% block content %}{% endblock %}
    </main>

    <!-- Footer -->
    <footer class="simple-footer" role="contentinfo">
      <div class="container">
        <div class="footer-content">
          <div class="footer-left">
            <span class="footer-brand">
              <span class="brand-icon" aria-hidden="true">&lt;/&gt;</span>
              <span class="brand-text">CodeXam</span>
            </span>
            <span class="footer-tagline">Elite Coding Arena</span>
          </div>
          
          <div class="footer-right">
            <div class="footer-status">
              <button class="system-info-btn" 
                      onclick="showSystemInfoModal();" 
                      aria-label="Open System Information"
                      type="button">
                <div class="status-dot" aria-hidden="true"></div>
                <span class="status-text">System Info</span>
              </button>
            </div>
            <div class="footer-copyright">
              <span>&copy; {{ current_year or 2024 }} CodeXam</span>
            </div>
          </div>
        </div>
      </div>
    </footer>

    <!-- Set Name Modal -->
    <div class="modal fade" 
         id="setNameModal" 
         tabindex="-1" 
         aria-labelledby="setNameModalLabel" 
         aria-hidden="true"
         aria-describedby="setNameModalDescription">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content cyber-card">
          <div class="modal-header border-bottom border-secondary">
            <h5 class="modal-title text-accent" id="setNameModalLabel">
              <span class="me-2" aria-hidden="true">üöÄ</span>
              Initialize Your Elite Journey
            </h5>
            <button type="button" 
                    class="btn-close btn-close-white" 
                    data-bs-dismiss="modal" 
                    aria-label="Close dialog">
            </button>
          </div>
          <div class="modal-body">
            <p class="text-secondary mb-4" id="setNameModalDescription">
              Join the ranks of elite developers mastering their craft through battle-tested challenges.
            </p>
            <form action="{{ url_for('set_name') }}" method="POST" id="setNameForm">
              <div class="mb-3">
                <label for="userName" class="form-label text-accent">Your Handle</label>
                <input type="text" 
                       class="form-control bg-tertiary border-primary text-primary" 
                       id="userName" 
                       name="user_name"
                       placeholder="Enter your coding handle"
                       maxlength="50"
                       required
                       aria-describedby="nameHelp">
                <div id="nameHelp" class="form-text text-muted">
                  This will be displayed on the leaderboard and with your submissions.
                </div>
              </div>
              <div class="form-check mb-3">
                <input class="form-check-input" 
                       type="checkbox" 
                       id="rememberName" 
                       name="remember" 
                       checked>
                <label class="form-check-label text-secondary" for="rememberName">
                  Remember my handle for future sessions
                </label>
              </div>
            </form>
          </div>
          <div class="modal-footer border-top border-secondary">
            <a href="{{ url_for('stay_anonymous') }}" 
               class="btn-cyber-secondary"
               role="button">
              Skip (Stay Anonymous)
            </a>
            <button type="submit" 
                    form="setNameForm" 
                    class="btn-cyber-primary">
              <span>Enter_Arena()</span>
              <span class="ms-2" aria-hidden="true">‚Üí</span>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Change Name Modal -->
    <div class="modal fade" id="changeNameModal" tabindex="-1" aria-labelledby="changeNameModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content cyber-card">
                <div class="modal-header border-bottom border-secondary">
                    <h5 class="modal-title text-accent" id="changeNameModalLabel">
                        <span class="me-2">‚öôÔ∏è</span>Update Your Handle
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form action="{{ url_for('set_name') }}" method="POST" id="changeNameForm">
                        <div class="mb-3">
                            <label for="newUserName" class="form-label text-accent">New Handle</label>
                            <input type="text" 
                                   class="form-control bg-tertiary border-primary text-primary" 
                                   id="newUserName" 
                                   name="user_name"
                                   value="{{ session.user_name or '' }}"
                                   maxlength="50"
                                   required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer border-top border-secondary">
                    <button type="button" class="btn-cyber-secondary" data-bs-dismiss="modal">
                        Cancel
                    </button>
                    <button type="submit" form="changeNameForm" class="btn-cyber-primary">
                        <span>Update_Handle()</span>
                        <span class="ms-2">‚Üí</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- System Info Modal -->
    <div id="systemInfoModal" 
         class="system-info-modal" 
         style="display: none; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0,0,0,0.9); z-index: 99999;" 
         role="dialog" 
         aria-labelledby="systemInfoTitle" 
         aria-describedby="systemInfoDescription"
         aria-modal="true"
         aria-hidden="true">
        
        <!-- Screen Reader Only Title -->
        <h1 id="systemInfoTitle" class="sr-only">CodeXam System Information Dashboard</h1>
        <div id="systemInfoDescription" class="sr-only">Interactive terminal interface showing real-time system diagnostics, platform statistics, performance metrics, and health monitoring data.</div>
        
        <!-- Skip Link for Keyboard Navigation -->
        <a href="#commandInput" class="skip-link">Skip to command input</a>
        
        <div class="terminal-container" style="padding: 50px; color: white; font-family: monospace;">
            <!-- Close Button -->
            <button class="terminal-close-btn" 
                    style="position: absolute; top: 20px; right: 20px; background: red; color: white; border: none; padding: 10px 15px; cursor: pointer; font-size: 18px;" 
                    onclick="hideSystemInfoModal();" 
                    aria-label="Close System Information Modal"
                    title="Close System Information Modal (Press Escape key)"
                    tabindex="0">
                <span aria-hidden="true">√ó</span>
            </button>
            
            <!-- Matrix Background Effect -->
            <div class="matrix-background" id="matrixBackground"></div>
            
            <!-- Terminal Content -->
            <div class="terminal-content">
                <!-- ASCII Art Header -->
                <div class="terminal-header" id="terminalHeader">
                    <pre class="ascii-art" id="asciiArt" style="color: #00ff88; font-size: 0.75rem; line-height: 1.2; text-shadow: 0 0 15px rgba(0, 255, 136, 0.6); text-align: center; margin-bottom: 2rem;">
 ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ñà‚ïó
‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ïë
‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó   ‚ïö‚ñà‚ñà‚ñà‚ïî‚ïù ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ñà‚ñà‚ñà‚ñà‚ïî‚ñà‚ñà‚ïë
‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù   ‚ñà‚ñà‚ïî‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë
‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïù ‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë ‚ïö‚ïê‚ïù ‚ñà‚ñà‚ïë
 ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù     ‚ïö‚ïê‚ïù
                                                              
        ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ñà‚ïó
        ‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïê‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ïë
        ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ïö‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïî‚ñà‚ñà‚ñà‚ñà‚ïî‚ñà‚ñà‚ïë
        ‚ïö‚ïê‚ïê‚ïê‚ïê‚ñà‚ñà‚ïë  ‚ïö‚ñà‚ñà‚ïî‚ïù  ‚ïö‚ïê‚ïê‚ïê‚ïê‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù  ‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë
        ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë ‚ïö‚ïê‚ïù ‚ñà‚ñà‚ïë
        ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù   ‚ïö‚ïê‚ïù   ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù   ‚ïö‚ïê‚ïù   ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïù     ‚ïö‚ïê‚ïù
                    </pre>
                </div>
                
                <!-- Boot Sequence -->
                <div class="boot-sequence" id="bootSequence">
                    <div class="boot-line">
                        <h2>üöÄ CodeXam System Information</h2>
                        <p>‚úÖ System Status: OPERATIONAL</p>
                        <p>‚úÖ Database: CONNECTED</p>
                        <p>‚úÖ Judge Engine: ONLINE</p>
                        <p>üìä Total Problems: 150+</p>
                        <p>üë• Active Users: 42</p>
                        <p>‚ö° Success Rate: 68.5%</p>
                        <br>
                        <p class="system-ready">üéØ System ready for your coding challenges!</p>
                        <br>
                        <p class="loading-text">Loading advanced terminal interface...</p>
                    </div>
                </div>
                
                <!-- Main Terminal Interface -->
                <div class="terminal-interface" 
                     id="terminalInterface" 
                     style="display: none; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 2.5rem; max-width: 1400px; margin: 0 auto;"
                     role="region"
                     aria-label="System Information Dashboard">
                     
                    <!-- System Status Panel -->
                    <section class="terminal-panel" 
                             style="background: rgba(0, 255, 136, 0.08); border: 1px solid rgba(0, 255, 136, 0.4); border-radius: 12px; padding: 2rem; position: relative; overflow: hidden; transition: all 0.3s ease; min-height: 200px;"
                             role="region"
                             aria-labelledby="systemStatusTitle"
                             aria-describedby="systemStatusContent">
                        <div class="panel-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid rgba(0, 255, 136, 0.3);">
                            <h2 id="systemStatusTitle" class="panel-title" style="color: #ff6b35; font-weight: 700; font-size: 1rem; letter-spacing: 1.5px; text-shadow: 0 0 10px rgba(255, 107, 53, 0.5);">[SYSTEM STATUS]</h2>
                            <span class="panel-status" id="systemStatus" style="color: #00ff88; font-size: 0.8rem;" aria-label="System Status: Operational">OPERATIONAL</span>
                        </div>
                        <div class="panel-content" 
                             id="systemStatusPanel" 
                             style="color: #00ff88; font-size: 0.95rem; line-height: 1.8; padding: 0.5rem 0;"
                             role="status"
                             aria-live="polite"
                             aria-atomic="false">
                            <div class="status-loading" style="color: #ffaa00;">Loading system diagnostics...</div>
                        </div>
                    </section>
                    
                    <!-- Statistics Panel -->
                    <section class="terminal-panel" 
                             style="background: rgba(0, 255, 136, 0.08); border: 1px solid rgba(0, 255, 136, 0.4); border-radius: 12px; padding: 2rem; position: relative; overflow: hidden; transition: all 0.3s ease; min-height: 200px;"
                             role="region"
                             aria-labelledby="statisticsTitle"
                             aria-describedby="statisticsContent">
                        <div class="panel-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid rgba(0, 255, 136, 0.3);">
                            <h2 id="statisticsTitle" class="panel-title" style="color: #ff6b35; font-weight: 700; font-size: 1rem; letter-spacing: 1.5px; text-shadow: 0 0 10px rgba(255, 107, 53, 0.5);">[PLATFORM STATISTICS]</h2>
                            <span class="panel-refresh" 
                                  id="statsRefresh" 
                                  style="color: #00ff88; font-size: 0.8rem;"
                                  aria-label="Statistics refreshing indicator"
                                  role="status">‚óè</span>
                        </div>
                        <div class="panel-content" 
                             id="platformStatsPanel" 
                             style="color: #00ff88; font-size: 0.95rem; line-height: 1.8; padding: 0.5rem 0;"
                             role="status"
                             aria-live="polite"
                             aria-atomic="false">
                            <div class="status-loading" style="color: #ffaa00;">Fetching platform data...</div>
                        </div>
                    </section>
                    
                    <!-- Performance Monitor -->
                    <section class="terminal-panel" 
                             style="background: rgba(0, 255, 136, 0.08); border: 1px solid rgba(0, 255, 136, 0.4); border-radius: 12px; padding: 2rem; position: relative; overflow: hidden; transition: all 0.3s ease; min-height: 200px;"
                             role="region"
                             aria-labelledby="performanceTitle"
                             aria-describedby="performanceContent">
                        <div class="panel-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid rgba(0, 255, 136, 0.3);">
                            <h2 id="performanceTitle" class="panel-title" style="color: #ff6b35; font-weight: 700; font-size: 1rem; letter-spacing: 1.5px; text-shadow: 0 0 10px rgba(255, 107, 53, 0.5);">[PERFORMANCE MONITOR]</h2>
                            <span class="panel-indicator" 
                                  id="performanceIndicator" 
                                  style="color: #00ff88; font-size: 0.8rem;"
                                  aria-label="Performance monitoring indicator"
                                  role="status">‚óè</span>
                        </div>
                        <div class="panel-content" 
                             id="performancePanel" 
                             style="color: #00ff88; font-size: 0.95rem; line-height: 1.8; padding: 0.5rem 0;"
                             role="status"
                             aria-live="polite"
                             aria-atomic="false">
                            <div class="status-loading" style="color: #ffaa00;">Analyzing performance metrics...</div>
                        </div>
                    </section>
                    
                    <!-- Language Statistics Panel -->
                    <section class="terminal-panel" 
                             style="background: rgba(0, 255, 136, 0.08); border: 1px solid rgba(0, 255, 136, 0.4); border-radius: 12px; padding: 2rem; position: relative; overflow: hidden; transition: all 0.3s ease; min-height: 200px;"
                             role="region"
                             aria-labelledby="languageTitle"
                             aria-describedby="languageContent">
                        <div class="panel-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid rgba(0, 255, 136, 0.3);">
                            <h2 id="languageTitle" class="panel-title" style="color: #ff6b35; font-weight: 700; font-size: 1rem; letter-spacing: 1.5px; text-shadow: 0 0 10px rgba(255, 107, 53, 0.5);">[LANGUAGE STATS]</h2>
                            <span class="panel-indicator" 
                                  id="languageIndicator" 
                                  style="color: #00ff88; font-size: 0.8rem;"
                                  aria-label="Language statistics indicator"
                                  role="status">‚óè</span>
                        </div>
                        <div class="panel-content" 
                             id="languageStatsPanel" 
                             style="color: #00ff88; font-size: 0.95rem; line-height: 1.8; padding: 0.5rem 0;"
                             role="status"
                             aria-live="polite"
                             aria-atomic="false">
                            <div class="status-loading" style="color: #ffaa00;">Loading language statistics...</div>
                        </div>
                    </section>
                    
                    <!-- Top Performers Panel -->
                    <section class="terminal-panel" 
                             style="background: rgba(0, 255, 136, 0.08); border: 1px solid rgba(0, 255, 136, 0.4); border-radius: 12px; padding: 2rem; position: relative; overflow: hidden; transition: all 0.3s ease; min-height: 200px;"
                             role="region"
                             aria-labelledby="performersTitle"
                             aria-describedby="performersContent">
                        <div class="panel-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid rgba(0, 255, 136, 0.3);">
                            <h2 id="performersTitle" class="panel-title" style="color: #ff6b35; font-weight: 700; font-size: 1rem; letter-spacing: 1.5px; text-shadow: 0 0 10px rgba(255, 107, 53, 0.5);">[TOP PERFORMERS]</h2>
                            <span class="panel-indicator" 
                                  id="performersIndicator" 
                                  style="color: #00ff88; font-size: 0.8rem;"
                                  aria-label="Top performers indicator"
                                  role="status">‚óè</span>
                        </div>
                        <div class="panel-content" 
                             id="topPerformersPanel" 
                             style="color: #00ff88; font-size: 0.95rem; line-height: 1.8; padding: 0.5rem 0;"
                             role="status"
                             aria-live="polite"
                             aria-atomic="false">
                            <div class="status-loading" style="color: #ffaa00;">Loading leaderboard...</div>
                        </div>
                    </section>
                    
                    <!-- Difficulty Distribution Panel -->
                    <section class="terminal-panel" 
                             style="background: rgba(0, 255, 136, 0.08); border: 1px solid rgba(0, 255, 136, 0.4); border-radius: 12px; padding: 2rem; position: relative; overflow: hidden; transition: all 0.3s ease; min-height: 200px;"
                             role="region"
                             aria-labelledby="difficultyTitle"
                             aria-describedby="difficultyContent">
                        <div class="panel-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid rgba(0, 255, 136, 0.3);">
                            <h2 id="difficultyTitle" class="panel-title" style="color: #ff6b35; font-weight: 700; font-size: 1rem; letter-spacing: 1.5px; text-shadow: 0 0 10px rgba(255, 107, 53, 0.5);">[DIFFICULTY DISTRIBUTION]</h2>
                            <span class="panel-indicator" 
                                  id="difficultyIndicator" 
                                  style="color: #00ff88; font-size: 0.8rem;"
                                  aria-label="Difficulty distribution indicator"
                                  role="status">‚óè</span>
                        </div>
                        <div class="panel-content" 
                             id="difficultyPanel" 
                             style="color: #00ff88; font-size: 0.95rem; line-height: 1.8; padding: 0.5rem 0;"
                             role="status"
                             aria-live="polite"
                             aria-atomic="false">
                            <div class="status-loading" style="color: #ffaa00;">Loading difficulty distribution...</div>
                        </div>
                    </section>
                    
                    <!-- Interactive Command Terminal -->
                    <section class="terminal-panel command-panel" 
                             style="grid-column: 1 / -1; min-height: 400px; margin-top: 2rem; background: rgba(0, 255, 136, 0.08); border: 1px solid rgba(0, 255, 136, 0.4); border-radius: 12px; padding: 2rem; position: relative; overflow: hidden; transition: all 0.3s ease;"
                             role="region"
                             aria-labelledby="terminalTitle"
                             aria-describedby="terminalDescription">
                        <div class="panel-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid rgba(0, 255, 136, 0.3);">
                            <h2 id="terminalTitle" class="panel-title" style="color: #ff6b35; font-weight: 700; font-size: 1rem; letter-spacing: 1.5px; text-shadow: 0 0 10px rgba(255, 107, 53, 0.5);">[INTERACTIVE TERMINAL]</h2>
                            <span class="panel-help" 
                                  style="color: #666; font-size: 0.7rem; font-style: italic;"
                                  id="terminalDescription">Type 'help' for commands</span>
                        </div>
                        <div class="panel-content">
                            <div class="command-output" 
                                 id="commandOutput" 
                                 style="max-height: 200px; overflow-y: auto; margin-bottom: 1rem; padding: 1rem; background: rgba(0, 0, 0, 0.3); border-radius: 4px; border: 1px solid rgba(0, 255, 136, 0.2);"
                                 role="log"
                                 aria-live="polite"
                                 aria-atomic="false"
                                 aria-label="Command output and history">
                                <div class="command-line" style="margin-bottom: 0.5rem; display: flex; align-items: center;">
                                    <span class="prompt" style="color: #ff6b35; margin-right: 0.5rem; font-weight: 600;" aria-hidden="true">codexam@system:~$</span>
                                    <span class="command-text" style="color: #00ff88;">Welcome to CodeXam System Terminal</span>
                                </div>
                                <div class="command-line" style="margin-bottom: 0.5rem; display: flex; align-items: center;">
                                    <span class="prompt" style="color: #ff6b35; margin-right: 0.5rem; font-weight: 600;" aria-hidden="true">codexam@system:~$</span>
                                    <span class="command-text" style="color: #00ff88;">Type 'help' to see available commands</span>
                                </div>
                            </div>
                            <div class="command-input-container" 
                                 style="display: flex; align-items: center; background: rgba(0, 0, 0, 0.5); border: 1px solid rgba(0, 255, 136, 0.3); border-radius: 4px; padding: 0.5rem;"
                                 role="group"
                                 aria-labelledby="commandInputLabel">
                                <label id="commandInputLabel" class="sr-only">Enter terminal command</label>
                                <span class="prompt" style="color: #ff6b35; margin-right: 0.5rem; font-weight: 600;" aria-hidden="true">codexam@system:~$</span>
                                <input type="text" 
                                       class="command-input" 
                                       id="commandInput" 
                                       placeholder="Enter command..." 
                                       autocomplete="off" 
                                       style="flex: 1; background: transparent; border: none; color: #00ff88; font-family: inherit; font-size: 0.9rem; outline: none; margin-left: 0.5rem;"
                                       aria-label="Terminal command input"
                                       aria-describedby="commandHelp"
                                       role="textbox"
                                       aria-autocomplete="list">
                                <div id="commandHelp" class="sr-only">Enter terminal commands like 'help', 'status', 'stats', 'health', or 'clear'. Press Enter to execute.</div>
                                <span class="cursor-blink" style="color: #00ff88; margin-left: 0.2rem;" aria-hidden="true">|</span>
                            </div>
                        </div>
                    </section>
    {% else %}
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
    {% endif %}
    
    <!-- System Info Modal JavaScript -->
    <script src="{{ url_for('static', filename='js/system-info-modal.js') }}"></script>
    <script src="{{ url_for('static', filename='js/system-stats-visualizer.js') }}"></script>
    <script src="{{ url_for('static', filename='js/system-command-processor.js') }}"></script>
    
    <!-- Custom JavaScript -->
    <script>
        // CLEAN SYSTEM INFO MODAL - GUARANTEED TO WORK
        console.log('üöÄ Loading clean modal script...');
        
        // Enhanced show function with proper terminal interface
        window.showSystemInfoModal = function() {
            console.log('üöÄ Enhanced showSystemInfoModal() called');
            
            const modal = document.getElementById('systemInfoModal');
            if (!modal) {
                console.error('‚ùå Modal not found!');
                alert('Modal not found!');
                return false;
            }
            
            console.log('‚úÖ Modal found, showing...');
            
            // Show modal
            modal.style.display = 'flex';
            modal.style.visibility = 'visible';
            modal.style.opacity = '1';
            modal.style.zIndex = '99999';
            modal.classList.add('show');
            document.body.style.overflow = 'hidden';
            
            // Initialize statistics visualizer
            if (typeof SystemStatsVisualizer !== 'undefined') {
                SystemStatsVisualizer.startUpdates();
                console.log('‚úÖ Statistics visualizer started');
            }
            
            // Start boot sequence and transition to terminal interface
            startBootSequence();
            
            console.log('‚úÖ Modal displayed with boot sequence');
            return true;
        };
        
        // Boot sequence and terminal interface transition
        function startBootSequence() {
            console.log('üöÄ Starting boot sequence...');
            
            const bootSequence = document.getElementById('bootSequence');
            const terminalInterface = document.getElementById('terminalInterface');
            
            // Ensure terminal interface is hidden initially
            if (terminalInterface) {
                terminalInterface.style.display = 'none';
                terminalInterface.style.opacity = '0';
            }
            
            // Show boot sequence
            if (bootSequence) {
                bootSequence.style.display = 'block';
                bootSequence.style.opacity = '1';
            }
            
            // Transition to terminal interface after 3 seconds
            setTimeout(() => {
                console.log('üîÑ Transitioning to terminal interface...');
                
                try {
                    // Hide boot sequence
                    if (bootSequence) {
                        bootSequence.style.opacity = '0';
                        bootSequence.style.transition = 'opacity 0.5s ease-out';
                        
                        setTimeout(() => {
                            bootSequence.style.display = 'none';
                        }, 500);
                    }
                    
                    // Show terminal interface
                    if (terminalInterface) {
                        terminalInterface.style.display = 'grid';
                        terminalInterface.style.opacity = '0';
                        terminalInterface.style.transition = 'opacity 0.5s ease-in';
                        
                        // Force reflow
                        terminalInterface.offsetHeight;
                        
                        setTimeout(() => {
                            terminalInterface.style.opacity = '1';
                            console.log('‚úÖ Terminal interface fully displayed');
                        }, 50);
                    }
                    
                    // Load system data and setup command input
                    setTimeout(() => {
                        loadSystemData();
                        setupCommandInput();
                        console.log('‚úÖ Terminal interface ready with data');
                    }, 600);
                    
                } catch (error) {
                    console.error('‚ùå Error during transition:', error);
                    
                    // Fallback: show terminal interface immediately
                    if (bootSequence) bootSequence.style.display = 'none';
                    if (terminalInterface) {
                        terminalInterface.style.display = 'grid';
                        terminalInterface.style.opacity = '1';
                    }
                    loadSystemData();
                    setupCommandInput();
                }
                
            }, 3000); // 3 second boot sequence
        }
        
        // Setup command input functionality
        function setupCommandInput() {
            console.log('‚å®Ô∏è Setting up command input...');
            
            const commandInput = document.getElementById('commandInput');
            if (commandInput) {
                commandInput.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter') {
                        const command = commandInput.value.trim();
                        if (command) {
                            processCommand(command);
                            commandInput.value = '';
                        }
                    }
                });
                
                // Focus the command input
                setTimeout(() => {
                    commandInput.focus();
                }, 100);
                
                console.log('‚úÖ Command input ready');
            } else {
                console.warn('‚ö†Ô∏è Command input element not found');
            }
        }
        
        // Process terminal commands
        function processCommand(command) {
            console.log('üîß Processing command:', command);
            
            const commandOutput = document.getElementById('commandOutput');
            if (!commandOutput) return;
            
            // Add command to output
            const commandLine = document.createElement('div');
            commandLine.className = 'command-line';
            commandLine.innerHTML = `<span class="prompt">codexam@system:~$</span> <span class="command-text">${command}</span>`;
            commandOutput.appendChild(commandLine);
            
            // Process the command
            let response = '';
            switch (command.toLowerCase()) {
                case 'help':
                    response = `Available commands:
  help     - Show this help message
  status   - Display system status
  stats    - Show platform statistics
  users    - Display user information
  clear    - Clear terminal screen
  exit     - Close system info modal`;
                    break;
                case 'status':
                    response = `System Status: OPERATIONAL
Database: CONNECTED
Judge Engine: ONLINE
Uptime: 72h 15m 42s
CPU Usage: 23.5%
Memory Usage: 45.2%`;
                    break;
                case 'stats':
                    response = `Platform Statistics:
Total Problems: 150+
Total Submissions: 8,934
Active Users: 42
Success Rate: 68.5%
Most Popular Language: Python (67%)`;
                    break;
                case 'users':
                    response = `User Statistics:
Registered Users: 1,247
Active Today: 42
Top Performer: CodeMaster (98 problems solved)
Average Success Rate: 68.5%`;
                    break;
                case 'clear':
                    commandOutput.innerHTML = '';
                    return;
                case 'exit':
                    hideSystemInfoModal();
                    return;
                default:
                    response = `Command not found: ${command}
Type 'help' for available commands.`;
            }
            
            // Add response to output
            const responseLine = document.createElement('div');
            responseLine.className = 'command-response';
            responseLine.style.color = '#00ff88';
            responseLine.style.marginBottom = '1rem';
            responseLine.style.whiteSpace = 'pre-line';
            responseLine.textContent = response;
            commandOutput.appendChild(responseLine);
            
            // Scroll to bottom
            commandOutput.scrollTop = commandOutput.scrollHeight;
        }
        
        // Simple hide function
        window.hideSystemInfoModal = function() {
            console.log('üîß CLEAN hideSystemInfoModal() called');
            
            const modal = document.getElementById('systemInfoModal');
            if (modal) {
                modal.style.display = 'none';
                modal.classList.remove('show');
                document.body.style.overflow = '';
                console.log('‚úÖ Modal hidden');
            }
        };
        
        // Escape key handler
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                const modal = document.getElementById('systemInfoModal');
                if (modal && modal.style.display !== 'none') {
                    hideSystemInfoModal();
                }
            }
        });
        
        // Test function
        window.testModal = function() {
            console.log('üîß Testing modal...');
            const modal = document.getElementById('systemInfoModal');
            console.log('Modal exists:', !!modal);
            console.log('Show function exists:', typeof window.showSystemInfoModal);
            
            if (modal) {
                showSystemInfoModal();
            }
        };
        
        // Load system data into panels with API calls
        function loadSystemData() {
            console.log('üìä Loading system data from API...');
            
            // Load data from API endpoints
            loadSystemDataFromAPI();
        }
        
        // Advanced data caching system
        class SystemInfoCache {
            constructor() {
                this.cache = new Map();
                this.config = {
                    maxSize: 50, // Maximum number of cached items
                    defaultTTL: 30000, // 30 seconds default TTL
                    cleanupInterval: 60000, // Cleanup every minute
                    persistToStorage: true, // Use localStorage for persistence
                    compressionEnabled: true // Enable data compression
                };
                
                this.stats = {
                    hits: 0,
                    misses: 0,
                    evictions: 0,
                    compressionRatio: 0
                };
                
                this.init();
            }
            
            init() {
                // Load cache from localStorage if available
                if (this.config.persistToStorage && typeof localStorage !== 'undefined') {
                    this.loadFromStorage();
                }
                
                // Start cleanup interval
                this.startCleanup();
                
                // Listen for storage events (multi-tab sync)
                if (typeof window !== 'undefined') {
                    window.addEventListener('storage', (e) => {
                        if (e.key === 'systemInfoCache') {
                            this.loadFromStorage();
                        }
                    });
                }
                
                console.log('üóÑÔ∏è SystemInfoCache initialized');
            }
            
            set(key, data, ttl = this.config.defaultTTL) {
                const now = Date.now();
                const expiresAt = now + ttl;
                
                // Compress data if enabled
                const compressedData = this.config.compressionEnabled ? 
                    this.compress(data) : data;
                
                const cacheItem = {
                    data: compressedData,
                    originalSize: JSON.stringify(data).length,
                    compressedSize: JSON.stringify(compressedData).length,
                    createdAt: now,
                    expiresAt: expiresAt,
                    accessCount: 0,
                    lastAccessed: now,
                    compressed: this.config.compressionEnabled
                };
                
                // Check cache size and evict if necessary
                if (this.cache.size >= this.config.maxSize) {
                    this.evictLRU();
                }
                
                this.cache.set(key, cacheItem);
                
                // Update compression ratio stats
                if (this.config.compressionEnabled) {
                    this.updateCompressionStats(cacheItem);
                }
                
                // Persist to storage
                if (this.config.persistToStorage) {
                    this.saveToStorage();
                }
                
                console.log(`üóÑÔ∏è Cached '${key}' (TTL: ${ttl}ms)`);
            }
            
            get(key) {
                const cacheItem = this.cache.get(key);
                
                if (!cacheItem) {
                    this.stats.misses++;
                    return null;
                }
                
                const now = Date.now();
                
                // Check if expired
                if (now > cacheItem.expiresAt) {
                    this.cache.delete(key);
                    this.stats.misses++;
                    console.log(`üóÑÔ∏è Cache expired for '${key}'`);
                    return null;
                }
                
                // Update access stats
                cacheItem.accessCount++;
                cacheItem.lastAccessed = now;
                this.stats.hits++;
                
                // Decompress data if needed
                const data = cacheItem.compressed ? 
                    this.decompress(cacheItem.data) : cacheItem.data;
                
                console.log(`üóÑÔ∏è Cache hit for '${key}' (age: ${now - cacheItem.createdAt}ms)`);
                return data;
            }
            
            has(key) {
                const cacheItem = this.cache.get(key);
                if (!cacheItem) return false;
                
                const now = Date.now();
                if (now > cacheItem.expiresAt) {
                    this.cache.delete(key);
                    return false;
                }
                
                return true;
            }
            
            delete(key) {
                const deleted = this.cache.delete(key);
                if (deleted) {
                    console.log(`üóÑÔ∏è Deleted cache entry '${key}'`);
                    if (this.config.persistToStorage) {
                        this.saveToStorage();
                    }
                }
                return deleted;
            }
            
            clear() {
                this.cache.clear();
                this.stats = { hits: 0, misses: 0, evictions: 0, compressionRatio: 0 };
                if (this.config.persistToStorage) {
                    this.saveToStorage();
                }
                console.log('üóÑÔ∏è Cache cleared');
            }
            
            evictLRU() {
                let oldestKey = null;
                let oldestTime = Date.now();
                
                for (const [key, item] of this.cache.entries()) {
                    if (item.lastAccessed < oldestTime) {
                        oldestTime = item.lastAccessed;
                        oldestKey = key;
                    }
                }
                
                if (oldestKey) {
                    this.cache.delete(oldestKey);
                    this.stats.evictions++;
                    console.log(`üóÑÔ∏è Evicted LRU cache entry '${oldestKey}'`);
                }
            }
            
            cleanup() {
                const now = Date.now();
                const expiredKeys = [];
                
                for (const [key, item] of this.cache.entries()) {
                    if (now > item.expiresAt) {
                        expiredKeys.push(key);
                    }
                }
                
                expiredKeys.forEach(key => this.cache.delete(key));
                
                if (expiredKeys.length > 0) {
                    console.log(`üóÑÔ∏è Cleaned up ${expiredKeys.length} expired cache entries`);
                    if (this.config.persistToStorage) {
                        this.saveToStorage();
                    }
                }
            }
            
            startCleanup() {
                setInterval(() => {
                    this.cleanup();
                }, this.config.cleanupInterval);
            }
            
            compress(data) {
                try {
                    // Simple compression using JSON stringify with reduced precision
                    const jsonString = JSON.stringify(data);
                    
                    // For demo purposes, we'll use a simple compression
                    // In production, you might use libraries like pako for gzip compression
                    return {
                        compressed: true,
                        data: jsonString,
                        algorithm: 'json'
                    };
                } catch (error) {
                    console.warn('üóÑÔ∏è Compression failed, storing uncompressed:', error);
                    return data;
                }
            }
            
            decompress(compressedData) {
                try {
                    if (compressedData.compressed && compressedData.algorithm === 'json') {
                        return JSON.parse(compressedData.data);
                    }
                    return compressedData;
                } catch (error) {
                    console.warn('üóÑÔ∏è Decompression failed:', error);
                    return compressedData;
                }
            }
            
            updateCompressionStats(cacheItem) {
                if (cacheItem.originalSize > 0) {
                    const ratio = (cacheItem.originalSize - cacheItem.compressedSize) / cacheItem.originalSize;
                    this.stats.compressionRatio = (this.stats.compressionRatio + ratio) / 2;
                }
            }
            
            saveToStorage() {
                try {
                    if (typeof localStorage === 'undefined') return;
                    
                    const cacheData = {
                        entries: Array.from(this.cache.entries()),
                        stats: this.stats,
                        timestamp: Date.now()
                    };
                    
                    localStorage.setItem('systemInfoCache', JSON.stringify(cacheData));
                } catch (error) {
                    console.warn('üóÑÔ∏è Failed to save cache to storage:', error);
                }
            }
            
            loadFromStorage() {
                try {
                    if (typeof localStorage === 'undefined') return;
                    
                    const stored = localStorage.getItem('systemInfoCache');
                    if (!stored) return;
                    
                    const cacheData = JSON.parse(stored);
                    
                    // Check if stored data is not too old (max 1 hour)
                    const maxAge = 60 * 60 * 1000; // 1 hour
                    if (Date.now() - cacheData.timestamp > maxAge) {
                        localStorage.removeItem('systemInfoCache');
                        return;
                    }
                    
                    // Restore cache entries
                    this.cache = new Map(cacheData.entries);
                    this.stats = cacheData.stats || this.stats;
                    
                    // Clean up expired entries
                    this.cleanup();
                    
                    console.log(`üóÑÔ∏è Loaded ${this.cache.size} cache entries from storage`);
                } catch (error) {
                    console.warn('üóÑÔ∏è Failed to load cache from storage:', error);
                    localStorage.removeItem('systemInfoCache');
                }
            }
            
            getStats() {
                const totalRequests = this.stats.hits + this.stats.misses;
                const hitRate = totalRequests > 0 ? (this.stats.hits / totalRequests * 100).toFixed(1) : 0;
                
                return {
                    ...this.stats,
                    hitRate: `${hitRate}%`,
                    cacheSize: this.cache.size,
                    maxSize: this.config.maxSize,
                    totalRequests
                };
            }
            
            // Cache invalidation strategies
            invalidatePattern(pattern) {
                const regex = new RegExp(pattern);
                const keysToDelete = [];
                
                for (const key of this.cache.keys()) {
                    if (regex.test(key)) {
                        keysToDelete.push(key);
                    }
                }
                
                keysToDelete.forEach(key => this.delete(key));
                console.log(`üóÑÔ∏è Invalidated ${keysToDelete.length} cache entries matching pattern: ${pattern}`);
            }
            
            invalidateByTag(tag) {
                const keysToDelete = [];
                
                for (const [key, item] of this.cache.entries()) {
                    if (item.tags && item.tags.includes(tag)) {
                        keysToDelete.push(key);
                    }
                }
                
                keysToDelete.forEach(key => this.delete(key));
                console.log(`üóÑÔ∏è Invalidated ${keysToDelete.length} cache entries with tag: ${tag}`);
            }
            
            // Preload data for better performance
            async preload(keys, fetcher) {
                const promises = keys.map(async (key) => {
                    if (!this.has(key)) {
                        try {
                            const data = await fetcher(key);
                            this.set(key, data);
                        } catch (error) {
                            console.warn(`üóÑÔ∏è Failed to preload '${key}':`, error);
                        }
                    }
                });
                
                await Promise.all(promises);
                console.log(`üóÑÔ∏è Preloaded ${keys.length} cache entries`);
            }
        }
        
        // Initialize the cache system
        const systemInfoCache = new SystemInfoCache();
        
        async function loadSystemDataFromAPI() {
            try {
                console.log('üìä Loading system data from API with advanced caching...');
                
                // Define cache keys and TTLs
                const cacheKeys = {
                    systemInfo: { key: 'api:system-info', ttl: 30000 }, // 30 seconds
                    platformStats: { key: 'api:platform-stats', ttl: 60000 }, // 1 minute
                    healthCheck: { key: 'api:health-check', ttl: 15000 } // 15 seconds
                };
                
                // Try to get data from cache first
                const cachedSystemInfo = systemInfoCache.get(cacheKeys.systemInfo.key);
                const cachedPlatformStats = systemInfoCache.get(cacheKeys.platformStats.key);
                const cachedHealthCheck = systemInfoCache.get(cacheKeys.healthCheck.key);
                
                // Determine which APIs need to be called
                const apisToFetch = [];
                if (!cachedSystemInfo) apisToFetch.push('systemInfo');
                if (!cachedPlatformStats) apisToFetch.push('platformStats');
                if (!cachedHealthCheck) apisToFetch.push('healthCheck');
                
                let systemInfoData = cachedSystemInfo;
                let platformStatsData = cachedPlatformStats;
                let healthCheckData = cachedHealthCheck;
                
                // Fetch missing data
                if (apisToFetch.length > 0) {
                    console.log(`üìä Fetching ${apisToFetch.length} API endpoints:`, apisToFetch);
                    
                    const fetchPromises = [];
                    
                    if (apisToFetch.includes('systemInfo')) {
                        fetchPromises.push(
                            fetchWithTimeout('/api/system-info')
                                .then(r => r.json())
                                .then(data => {
                                    systemInfoCache.set(cacheKeys.systemInfo.key, data, cacheKeys.systemInfo.ttl);
                                    return { type: 'systemInfo', data };
                                })
                        );
                    }
                    
                    if (apisToFetch.includes('platformStats')) {
                        fetchPromises.push(
                            fetchWithTimeout('/api/platform-stats')
                                .then(r => r.json())
                                .then(data => {
                                    systemInfoCache.set(cacheKeys.platformStats.key, data, cacheKeys.platformStats.ttl);
                                    return { type: 'platformStats', data };
                                })
                        );
                    }
                    
                    if (apisToFetch.includes('healthCheck')) {
                        fetchPromises.push(
                            fetchWithTimeout('/api/health-check')
                                .then(r => r.json())
                                .then(data => {
                                    systemInfoCache.set(cacheKeys.healthCheck.key, data, cacheKeys.healthCheck.ttl);
                                    return { type: 'healthCheck', data };
                                })
                        );
                    }
                    
                    // Wait for all API calls to complete
                    const results = await Promise.allSettled(fetchPromises);
                    
                    // Process results
                    results.forEach((result, index) => {
                        if (result.status === 'fulfilled') {
                            const { type, data } = result.value;
                            switch (type) {
                                case 'systemInfo':
                                    systemInfoData = data;
                                    break;
                                case 'platformStats':
                                    platformStatsData = data;
                                    break;
                                case 'healthCheck':
                                    healthCheckData = data;
                                    break;
                            }
                        } else {
                            console.warn(`‚ùå API call failed:`, result.reason);
                        }
                    });
                }
                
                // Update panels with available data
                if (systemInfoData) {
                    updateSystemStatusPanel(systemInfoData.data);
                    updatePerformancePanel(systemInfoData.data?.performance);
                }
                if (platformStatsData) {
                    updateStatisticsPanel(platformStatsData.data);
                }
                if (healthCheckData) {
                    updateHealthPanel(healthCheckData.data);
                }
                
                // Log cache statistics
                const cacheStats = systemInfoCache.getStats();
                console.log('üóÑÔ∏è Cache stats:', cacheStats);
                
                console.log('‚úÖ System data loaded successfully');
                
                // Announce to screen reader
                if (window.announceToScreenReader) {
                    const cacheHits = apisToFetch.length < 3 ? 3 - apisToFetch.length : 0;
                    const message = cacheHits > 0 ? 
                        `System data updated (${cacheHits} from cache, ${apisToFetch.length} from server)` :
                        'System data updated from server';
                    announceToScreenReader(message);
                }
                
            } catch (error) {
                console.error('‚ùå Error loading system data from API:', error);
                
                // Try to use any available cached data
                const fallbackData = {
                    systemInfo: systemInfoCache.get('api:system-info'),
                    platformStats: systemInfoCache.get('api:platform-stats'),
                    healthCheck: systemInfoCache.get('api:health-check')
                };
                
                let hasAnyData = false;
                
                if (fallbackData.systemInfo) {
                    updateSystemStatusPanel(fallbackData.systemInfo.data);
                    updatePerformancePanel(fallbackData.systemInfo.data?.performance);
                    hasAnyData = true;
                }
                if (fallbackData.platformStats) {
                    updateStatisticsPanel(fallbackData.platformStats.data);
                    hasAnyData = true;
                }
                if (fallbackData.healthCheck) {
                    updateHealthPanel(fallbackData.healthCheck.data);
                    hasAnyData = true;
                }
                
                if (!hasAnyData) {
                    console.log('üìä No cached data available, falling back to mock data');
                    loadMockSystemData();
                }
                
                // Announce error to screen reader
                if (window.announceToScreenReader) {
                    const message = hasAnyData ? 
                        'Unable to fetch latest data, showing cached information' :
                        'Unable to fetch data, showing sample information';
                    announceToScreenReader(message);
                }
            }
        }
        
        // Enhanced fetch with timeout and retry
        async function fetchWithTimeout(url, timeout = 5000, retries = 2) {
            for (let attempt = 0; attempt <= retries; attempt++) {
                try {
                    const controller = new AbortController();
                    const timeoutId = setTimeout(() => controller.abort(), timeout);
                    
                    const response = await fetch(url, {
                        signal: controller.signal,
                        headers: {
                            'Cache-Control': 'no-cache',
                            'X-Requested-With': 'XMLHttpRequest'
                        }
                    });
                    
                    clearTimeout(timeoutId);
                    
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }
                    
                    return response;
                    
                } catch (error) {
                    if (attempt === retries) {
                        throw error;
                    }
                    
                    console.warn(`‚ö†Ô∏è Fetch attempt ${attempt + 1} failed for ${url}, retrying...`);
                    await new Promise(resolve => setTimeout(resolve, 1000 * (attempt + 1))); // Exponential backoff
                }
            }
        }
        
        function updateSystemStatusPanel(systemData) {
            const statusContent = document.getElementById('systemStatusContent');
            if (statusContent && systemData) {
                statusContent.innerHTML = `
                    <div class="status-line" style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15);">
                        <span style="color: #aaa;">Database</span>
                        <span style="color: #00ff88; font-weight: 600;">${systemData.database?.status || 'UNKNOWN'}</span>
                    </div>
                    <div class="status-line" style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15);">
                        <span style="color: #aaa;">Platform</span>
                        <span style="color: #00ff88; font-weight: 600;">${systemData.platform?.status || 'OPERATIONAL'}</span>
                    </div>
                    <div class="status-line" style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15);">
                        <span style="color: #aaa;">Version</span>
                        <span style="color: #00ff88; font-weight: 600;">${systemData.platform?.version || '2.1.0'}</span>
                    </div>
                    <div class="status-line" style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding: 0.75rem 0;">
                        <span style="color: #aaa;">Uptime</span>
                        <span style="color: #00ff88; font-weight: 600;" data-live-id="uptimeDisplay">${systemData.platform?.uptime || '24h 15m'}</span>
                    </div>
                `;
            }
        }
        
        function updateStatisticsPanel(statsData) {
            const statsContent = document.getElementById('statisticsContent');
            if (statsContent && statsData) {
                // Create advanced statistics visualization
                const visualizations = createAdvancedStatisticsVisualization(statsData);
                
                statsContent.innerHTML = `
                    <div class="stats-overview">
                        <div class="stat-item" style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15);">
                            <span style="color: #aaa;">üìä Total Problems</span>
                            <span style="color: #00ff88; font-weight: 600;">${statsData.total_problems || 156}</span>
                        </div>
                        <div class="stat-item" style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15);">
                            <span style="color: #aaa;">üìù Total Submissions</span>
                            <span style="color: #00ff88; font-weight: 600;" data-live-id="totalSubmissionsDisplay">${statsData.total_submissions || 12847}</span>
                        </div>
                        <div class="stat-item" style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15);">
                            <span style="color: #aaa;">üë• Active Users</span>
                            <span style="color: #00ff88; font-weight: 600;" data-live-id="activeUsersDisplay">${statsData.active_users_today || 42}</span>
                        </div>
                        <div class="stat-item" style="display: flex; justify-content: space-between; margin-bottom: 1.5rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15);">
                            <span style="color: #aaa;">‚ö° Success Rate</span>
                            <span style="color: #00ff88; font-weight: 600;">${statsData.overall_success_rate || '68.5%'}</span>
                        </div>
                    </div>
                    
                    <div class="stats-visualizations">
                        ${visualizations.difficultyChart}
                        ${visualizations.languageChart}
                        ${visualizations.trendChart}
                        ${visualizations.leaderboard}
                    </div>
                `;
            }
        }
        
        function createAdvancedStatisticsVisualization(statsData) {
            return {
                difficultyChart: createDifficultyDistributionChart(statsData),
                languageChart: createLanguageDistributionChart(statsData),
                trendChart: createSubmissionTrendChart(statsData),
                leaderboard: createTopPerformersDisplay(statsData)
            };
        }
        
        function createDifficultyDistributionChart(statsData) {
            const difficulties = statsData.problems_by_difficulty || { Easy: 62, Medium: 71, Hard: 23 };
            const total = Object.values(difficulties).reduce((sum, count) => sum + count, 0);
            
            // Create ASCII bar chart
            const maxBarLength = 20;
            const maxValue = Math.max(...Object.values(difficulties));
            
            let chart = `
                <div class="ascii-chart" style="margin-bottom: 1.5rem; padding: 1rem; background: rgba(0, 0, 0, 0.3); border-radius: 6px; border: 1px solid rgba(0, 255, 136, 0.2);">
                    <div style="color: #ff6b35; font-weight: 600; margin-bottom: 0.75rem; font-size: 0.9rem;">üìä PROBLEM DIFFICULTY DISTRIBUTION</div>
                    <div style="font-family: monospace; font-size: 0.8rem; line-height: 1.4;">`;
            
            Object.entries(difficulties).forEach(([difficulty, count]) => {
                const percentage = ((count / total) * 100).toFixed(1);
                const barLength = Math.round((count / maxValue) * maxBarLength);
                const bar = '‚ñà'.repeat(barLength) + '‚ñë'.repeat(maxBarLength - barLength);
                
                const color = difficulty === 'Easy' ? '#00ff88' : 
                             difficulty === 'Medium' ? '#ffaa00' : '#ff6b35';
                
                chart += `
                    <div style="margin-bottom: 0.4rem;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.2rem;">
                            <span style="color: #aaa; width: 60px;">${difficulty}</span>
                            <span style="color: ${color}; font-weight: 600;">${count} (${percentage}%)</span>
                        </div>
                        <div style="color: ${color};">${bar}</div>
                    </div>`;
            });
            
            chart += `
                    </div>
                </div>`;
            
            return chart;
        }
        
        function createLanguageDistributionChart(statsData) {
            const languages = statsData.submissions_by_language || 
                { python: 1247, javascript: 892, java: 634, cpp: 423 };
            
            const total = Object.values(languages).reduce((sum, count) => sum + count, 0);
            const maxValue = Math.max(...Object.values(languages));
            const maxBarLength = 15;
            
            let chart = `
                <div class="ascii-chart" style="margin-bottom: 1.5rem; padding: 1rem; background: rgba(0, 0, 0, 0.3); border-radius: 6px; border: 1px solid rgba(0, 255, 136, 0.2);">
                    <div style="color: #ff6b35; font-weight: 600; margin-bottom: 0.75rem; font-size: 0.9rem;">üíª LANGUAGE POPULARITY</div>
                    <div style="font-family: monospace; font-size: 0.8rem; line-height: 1.4;">`;
            
            Object.entries(languages).forEach(([language, count]) => {
                const percentage = ((count / total) * 100).toFixed(1);
                const barLength = Math.round((count / maxValue) * maxBarLength);
                const bar = '‚ñì'.repeat(barLength) + '‚ñë'.repeat(maxBarLength - barLength);
                
                chart += `
                    <div style="margin-bottom: 0.4rem;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.2rem;">
                            <span style="color: #aaa; width: 80px;">${language}</span>
                            <span style="color: #00ff88; font-weight: 600;">${count} (${percentage}%)</span>
                        </div>
                        <div style="color: #00ff88;">${bar}</div>
                    </div>`;
            });
            
            chart += `
                    </div>
                </div>`;
            
            return chart;
        }
        
        function createSubmissionTrendChart(statsData) {
            // Generate trend data (in real implementation, this would come from the API)
            const trendData = generateTrendData();
            const maxValue = Math.max(...trendData);
            const chartHeight = 8;
            
            let chart = `
                <div class="ascii-chart" style="margin-bottom: 1.5rem; padding: 1rem; background: rgba(0, 0, 0, 0.3); border-radius: 6px; border: 1px solid rgba(0, 255, 136, 0.2);">
                    <div style="color: #ff6b35; font-weight: 600; margin-bottom: 0.75rem; font-size: 0.9rem;">üìà SUBMISSION TREND (24H)</div>
                    <div style="font-family: monospace; font-size: 0.7rem; line-height: 1.2;">`;
            
            // Create ASCII line chart
            for (let row = chartHeight - 1; row >= 0; row--) {
                let line = '';
                const threshold = (row / (chartHeight - 1)) * maxValue;
                
                for (let col = 0; col < trendData.length; col++) {
                    if (trendData[col] >= threshold) {
                        line += '‚ñì';
                    } else {
                        line += ' ';
                    }
                }
                
                const value = Math.round(threshold);
                chart += `<div style="color: #00ff88;">${value.toString().padStart(3, ' ')} ‚îÇ${line}</div>`;
            }
            
            // Add time labels
            chart += `<div style="color: #666; margin-top: 0.3rem;">    ‚îî${'‚îÄ'.repeat(trendData.length)}</div>`;
            chart += `<div style="color: #666; margin-left: 5px;">00h    06h    12h    18h    24h</div>`;
            
            chart += `
                    </div>
                </div>`;
            
            return chart;
        }
        
        function createTopPerformersDisplay(statsData) {
            const topPerformers = statsData.top_performers || [
                { name: 'CodeMaster', solved: 89, streak: 12 },
                { name: 'AlgoNinja', solved: 76, streak: 8 },
                { name: 'DevGuru', solved: 68, streak: 15 },
                { name: 'ByteWiz', solved: 54, streak: 6 },
                { name: 'LogicLord', solved: 47, streak: 9 }
            ];
            
            let leaderboard = `
                <div class="ascii-chart" style="margin-bottom: 1rem; padding: 1rem; background: rgba(0, 0, 0, 0.3); border-radius: 6px; border: 1px solid rgba(0, 255, 136, 0.2);">
                    <div style="color: #ff6b35; font-weight: 600; margin-bottom: 0.75rem; font-size: 0.9rem;">üèÜ TOP PERFORMERS</div>
                    <div style="font-family: monospace; font-size: 0.8rem; line-height: 1.4;">
                        <div style="color: #666; margin-bottom: 0.5rem; padding-bottom: 0.3rem; border-bottom: 1px solid rgba(0, 255, 136, 0.1);">
                            RANK  USER          SOLVED  STREAK
                        </div>`;
            
            topPerformers.forEach((performer, index) => {
                const rank = (index + 1).toString().padStart(2, ' ');
                const name = performer.name.padEnd(12, ' ');
                const solved = performer.solved.toString().padStart(6, ' ');
                const streak = performer.streak.toString().padStart(6, ' ');
                
                const rankColor = index === 0 ? '#ffaa00' : index === 1 ? '#aaa' : index === 2 ? '#ff6b35' : '#00ff88';
                const medal = index === 0 ? 'ü•á' : index === 1 ? 'ü•à' : index === 2 ? 'ü•â' : '  ';
                
                leaderboard += `
                    <div style="margin-bottom: 0.3rem;">
                        <span style="color: ${rankColor};">${medal} ${rank}</span>
                        <span style="color: #00ff88; margin-left: 0.5rem;">${name}</span>
                        <span style="color: #aaa;">${solved}</span>
                        <span style="color: #ffaa00;">${streak}</span>
                    </div>`;
            });
            
            leaderboard += `
                    </div>
                </div>`;
            
            return leaderboard;
        }
        
        function generateTrendData() {
            // Generate realistic trend data for 24 hours
            const hours = 24;
            const data = [];
            
            for (let i = 0; i < hours; i++) {
                // Simulate daily activity pattern
                let baseActivity = 50;
                
                // Higher activity during work hours (9-17) and evening (19-22)
                if ((i >= 9 && i <= 17) || (i >= 19 && i <= 22)) {
                    baseActivity = 80;
                }
                
                // Lower activity during night hours (23-6)
                if (i >= 23 || i <= 6) {
                    baseActivity = 20;
                }
                
                // Add some randomness
                const activity = baseActivity + (Math.random() - 0.5) * 30;
                data.push(Math.max(0, Math.round(activity)));
            }
            
            return data;
        }
        
        function updatePerformancePanel(perfData) {
            const perfContent = document.getElementById('performanceContent');
            if (perfContent && perfData) {
                perfContent.innerHTML = `
                    <div class="metric-item" style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15);">
                        <span style="color: #aaa;">‚ö° Response Time</span>
                        <span style="color: #00ff88; font-weight: 600;" data-live-id="responseTimeDisplay">${perfData.response_time || '45ms'}</span>
                    </div>
                    <div class="metric-item" style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15);">
                        <span style="color: #aaa;">üß† Memory Usage</span>
                        <span style="color: #00ff88; font-weight: 600;" data-live-id="memoryUsageDisplay">${perfData.memory_usage || '62%'}</span>
                    </div>
                    <div class="metric-item" style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15);">
                        <span style="color: #aaa;">üî• CPU Usage</span>
                        <span style="color: #00ff88; font-weight: 600;" data-live-id="cpuUsageDisplay">${perfData.cpu_usage || '28%'}</span>
                    </div>
                    <div class="metric-item" style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding: 0.75rem 0;">
                        <span style="color: #aaa;">üîó Active Connections</span>
                        <span style="color: #00ff88; font-weight: 600;" data-live-id="connectionsDisplay">${perfData.active_connections || 34}</span>
                    </div>
                `;
            }
        }
        
        function updateHealthPanel(healthData) {
            const healthContent = document.getElementById('healthContent');
            if (healthContent && healthData) {
                const memoryUsage = healthData.metrics?.memory_usage || '62%';
                const cpuUsage = healthData.metrics?.cpu_usage || '28%';
                const memoryPercent = parseInt(memoryUsage);
                const cpuPercent = parseInt(cpuUsage);
                
                healthContent.innerHTML = `
                    <div class="status-line" style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15);" role="group" aria-labelledby="systemHealthLabel">
                        <span id="systemHealthLabel" class="status-label" style="color: #aaa;">üè• System Health</span>
                        <span class="status-value" style="color: #00ff88; font-weight: 600;" data-live-id="systemHealthDisplay" aria-describedby="systemHealthLabel">${healthData.overall_status || 'HEALTHY'}</span>
                    </div>
                    <div style="margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15);" role="group" aria-labelledby="memoryUsageLabel">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                            <span id="memoryUsageLabel" class="status-label" style="color: #aaa;">üíæ Memory Usage</span>
                            <span class="status-value" style="color: #00ff88; font-weight: 600;" data-live-id="healthMemoryDisplay" aria-describedby="memoryUsageLabel">${memoryUsage}</span>
                        </div>
                        <div style="width: 100%; height: 6px; background: rgba(0, 255, 136, 0.2); border-radius: 3px; overflow: hidden;" role="progressbar" aria-valuenow="${memoryPercent}" aria-valuemin="0" aria-valuemax="100" aria-labelledby="memoryUsageLabel">
                            <div style="height: 100%; width: ${memoryPercent}%; background: linear-gradient(90deg, #00ff88, #00ff41); border-radius: 3px; transition: width 0.5s ease;" data-live-id="healthMemoryBar"></div>
                        </div>
                    </div>
                    <div style="margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15);" role="group" aria-labelledby="cpuUsageLabel">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                            <span id="cpuUsageLabel" class="status-label" style="color: #aaa;">üî• CPU Usage</span>
                            <span class="status-value" style="color: #00ff88; font-weight: 600;" data-live-id="healthCpuDisplay" aria-describedby="cpuUsageLabel">${cpuUsage}</span>
                        </div>
                        <div style="width: 100%; height: 6px; background: rgba(0, 255, 136, 0.2); border-radius: 3px; overflow: hidden;" role="progressbar" aria-valuenow="${cpuPercent}" aria-valuemin="0" aria-valuemax="100" aria-labelledby="cpuUsageLabel">
                            <div style="height: 100%; width: ${cpuPercent}%; background: linear-gradient(90deg, #00ff88, #00ff41); border-radius: 3px; transition: width 0.5s ease;" data-live-id="healthCpuBar"></div>
                        </div>
                    </div>
                    <div class="status-line" style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15);" role="group" aria-labelledby="warningsLabel">
                        <span id="warningsLabel" class="status-label" style="color: #aaa;">‚ö†Ô∏è Active Warnings</span>
                        <span class="status-value" style="color: #00ff88; font-weight: 600;" data-live-id="warningsDisplay" aria-describedby="warningsLabel">${healthData.warnings?.length || 0}</span>
                    </div>
                    <div class="status-line" style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding: 0.75rem 0;" role="group" aria-labelledby="lastCheckLabel">
                        <span id="lastCheckLabel" class="status-label" style="color: #aaa;">üîç Last Health Check</span>
                        <span class="status-value" style="color: #00ff88; font-weight: 600;" data-live-id="lastCheckDisplay" aria-describedby="lastCheckLabel">Just now</span>
                    </div>
                `;
            }
        }
        
        // Offline data support
        const offlineDataManager = {
            isOnline: navigator.onLine,
            
            init() {
                // Listen for online/offline events
                window.addEventListener('online', () => {
                    this.isOnline = true;
                    console.log('üåê Connection restored - switching to online mode');
                    if (window.announceToScreenReader) {
                        announceToScreenReader('Internet connection restored');
                    }
                    // Refresh data when coming back online
                    loadSystemDataFromAPI();
                });
                
                window.addEventListener('offline', () => {
                    this.isOnline = false;
                    console.log('üì¥ Connection lost - switching to offline mode');
                    if (window.announceToScreenReader) {
                        announceToScreenReader('Internet connection lost, using cached data');
                    }
                });
            },
            
            getOfflineData() {
                // Try to get the most recent cached data
                const offlineData = {
                    systemInfo: systemInfoCache.get('api:system-info'),
                    platformStats: systemInfoCache.get('api:platform-stats'),
                    healthCheck: systemInfoCache.get('api:health-check')
                };
                
                // If no cached data, provide static fallback
                if (!offlineData.systemInfo && !offlineData.platformStats && !offlineData.healthCheck) {
                    return this.getStaticFallbackData();
                }
                
                return offlineData;
            },
            
            getStaticFallbackData() {
                return {
                    systemInfo: {
                        data: {
                            platform: {
                                name: 'CodeXam Elite Arena',
                                version: '2.1.0',
                                status: 'OFFLINE',
                                uptime: 'Unknown'
                            },
                            database: {
                                status: 'OFFLINE',
                                response_time: 'N/A'
                            },
                            performance: {
                                cpu_usage: 'N/A',
                                memory_usage: 'N/A',
                                response_time: 'N/A',
                                active_connections: 'N/A'
                            }
                        }
                    },
                    platformStats: {
                        data: {
                            total_problems: 'N/A',
                            total_submissions: 'N/A',
                            active_users_today: 'N/A',
                            overall_success_rate: 'N/A'
                        }
                    },
                    healthCheck: {
                        data: {
                            overall_status: 'OFFLINE',
                            metrics: {
                                memory_usage: 'N/A',
                                cpu_usage: 'N/A'
                            },
                            warnings: []
                        }
                    }
                };
            }
        };
        
        // Initialize offline support
        offlineDataManager.init();
        
        function loadMockSystemData() {
            console.log('üìä Loading fallback system data...');
            
            // Check if we're offline and have cached data
            if (!offlineDataManager.isOnline) {
                const offlineData = offlineDataManager.getOfflineData();
                
                if (offlineData.systemInfo) {
                    updateSystemStatusPanel(offlineData.systemInfo.data);
                    updatePerformancePanel(offlineData.systemInfo.data?.performance);
                }
                if (offlineData.platformStats) {
                    updateStatisticsPanel(offlineData.platformStats.data);
                }
                if (offlineData.healthCheck) {
                    updateHealthPanel(offlineData.healthCheck.data);
                }
                
                console.log('üì¥ Loaded offline/cached data');
                return;
            }
            
            // Generate mock data for online fallback
            
            // Load system status from API
            loadSystemStatus();
            
            // Load platform statistics from API
            loadPlatformStatistics();
            
            // Load performance metrics from API
            loadPerformanceMetrics();
            
            // Load health monitoring data from API
            loadHealthMonitoring();
        }
        
        function loadSystemStatus() {
            const statusContent = document.getElementById('systemStatusContent');
            if (!statusContent) return;
            
            // Show loading state
            statusContent.innerHTML = '<div class="status-loading" style="color: #ffaa00;">Loading system status...</div>';
            
            fetch('/api/system-info')
                .then(response => response.json())
                .then(data => {
                    if (data.status === 'success') {
                        const systemInfo = data.data;
                        statusContent.innerHTML = `
                            <div class="status-line" style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15);">
                                <span style="color: #aaa;">Database</span>
                                <span style="color: #00ff88; font-weight: 600;">‚úÖ ${systemInfo.database.status}</span>
                            </div>
                            <div class="status-line" style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15);">
                                <span style="color: #aaa;">Platform</span>
                                <span style="color: #00ff88; font-weight: 600;">‚úÖ ${systemInfo.platform.status}</span>
                            </div>
                            <div class="status-line" style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15);">
                                <span style="color: #aaa;">Version</span>
                                <span style="color: #00ff88; font-weight: 600;">${systemInfo.platform.version}</span>
                            </div>
                            <div class="status-line" style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding: 0.75rem 0;">
                                <span style="color: #aaa;">Uptime</span>
                                <span style="color: #00ff88; font-weight: 600;" data-live-id="uptimeDisplay">${systemInfo.platform.uptime}</span>
                            </div>
                        `;
                    } else {
                        throw new Error(data.message || 'Failed to load system status');
                    }
                })
                .catch(error => {
                    console.error('Error loading system status:', error);
                    statusContent.innerHTML = `
                        <div style="color: #ff4444;">Failed to load system status</div>
                        <div style="color: #666; font-size: 0.8rem; margin-top: 0.5rem;">Using fallback data</div>
                        <div style="display: flex; justify-content: space-between; margin-top: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15);">
                            <span style="color: #aaa;">Database</span>
                            <span style="color: #00ff88; font-weight: 600;">‚úÖ CONNECTED</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding: 0.75rem 0;">
                            <span style="color: #aaa;">Uptime</span>
                            <span style="color: #00ff88; font-weight: 600;" data-live-id="uptimeDisplay">24h 15m</span>
                        </div>
                    `;
                });
        }
            
        function loadPlatformStatistics() {
            const statsContent = document.getElementById('statisticsContent');
            if (!statsContent) return;
            
            // Show loading state
            statsContent.innerHTML = '<div class="status-loading" style="color: #ffaa00;">Loading platform statistics...</div>';
            
            fetch('/api/platform-stats')
                .then(response => response.json())
                .then(data => {
                    if (data.status === 'success') {
                        const stats = data.data.overview;
                        statsContent.innerHTML = `
                            <div class="stat-item" style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15);">
                                <span style="color: #aaa;">üìä Total Problems</span>
                                <span style="color: #00ff88; font-weight: 600;">${stats.total_problems}</span>
                            </div>
                            <div class="stat-item" style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15);">
                                <span style="color: #aaa;">üìù Total Submissions</span>
                                <span style="color: #00ff88; font-weight: 600;" data-live-id="totalSubmissionsDisplay">${stats.total_submissions.toLocaleString()}</span>
                            </div>
                            <div class="stat-item" style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15);">
                                <span style="color: #aaa;">üë• Active Users Today</span>
                                <span style="color: #00ff88; font-weight: 600;" data-live-id="activeUsersDisplay">${stats.active_users_today}</span>
                            </div>
                            <div class="stat-item" style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15);">
                                <span style="color: #aaa;">üìà Submissions Today</span>
                                <span style="color: #00ff88; font-weight: 600;">${stats.submissions_today}</span>
                            </div>
                            <div class="stat-item" style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding: 0.75rem 0;">
                                <span style="color: #aaa;">‚ö° Success Rate</span>
                                <span style="color: #00ff88; font-weight: 600;">${stats.success_rate}</span>
                            </div>
                        `;
                    } else {
                        throw new Error(data.message || 'Failed to load platform statistics');
                    }
                })
                .catch(error => {
                    console.error('Error loading platform statistics:', error);
                    statsContent.innerHTML = `
                        <div style="color: #ff4444;">Failed to load statistics</div>
                        <div style="color: #666; font-size: 0.8rem; margin-top: 0.5rem;">Using fallback data</div>
                        <div style="display: flex; justify-content: space-between; margin-top: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15);">
                            <span style="color: #aaa;">üìä Total Problems</span>
                            <span style="color: #00ff88; font-weight: 600;">156</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding: 0.75rem 0;">
                            <span style="color: #aaa;">‚ö° Success Rate</span>
                            <span style="color: #00ff88; font-weight: 600;">68.5%</span>
                        </div>
                    `;
                });
        }
            
        function loadPerformanceMetrics() {
            const perfContent = document.getElementById('performanceContent');
            if (!perfContent) return;
            
            // Show loading state
            perfContent.innerHTML = '<div class="status-loading" style="color: #ffaa00;">Loading performance metrics...</div>';
            
            fetch('/</div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15);">
                        <span style="color: #aaa;">üß† Memory Usage</span>
                        <span style="color: #00ff88; font-weight: 600;" data-live-id="memoryUsageDisplay">62%</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15);">
                        <span style="color: #aaa;">üî• CPU Usage</span>
                        <span style="color: #00ff88; font-weight: 600;" data-live-id="cpuUsageDisplay">28%</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding: 0.75rem 0;">
                        <span style="color: #aaa;">üîó Active Connections</span>
                        <span style="color: #00ff88; font-weight: 600;" data-live-id="connectionsDisplay">34</span>
                    </div>
                `;
            }
            
            // Load health monitoring data
            const healthContent = document.getElementById('healthContent');
            if (healthContent) {
                healthContent.innerHTML = `
                    <div class="status-line" style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15);" role="group" aria-labelledby="systemHealthLabel">
                        <span id="systemHealthLabel" class="status-label" style="color: #aaa;">üè• System Health</span>
                        <span class="status-value" style="color: #00ff88; font-weight: 600;" data-live-id="systemHealthDisplay" aria-describedby="systemHealthLabel">HEALTHY</span>
                    </div>
                    <div style="margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15);" role="group" aria-labelledby="memoryUsageLabel">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                            <span id="memoryUsageLabel" class="status-label" style="color: #aaa;">üíæ Memory Usage</span>
                            <span class="status-value" style="color: #00ff88; font-weight: 600;" data-live-id="healthMemoryDisplay" aria-describedby="memoryUsageLabel">62%</span>
                        </div>
                        <div style="width: 100%; height: 6px; background: rgba(0, 255, 136, 0.2); border-radius: 3px; overflow: hidden;" role="progressbar" aria-valuenow="62" aria-valuemin="0" aria-valuemax="100" aria-labelledby="memoryUsageLabel">
                            <div style="height: 100%; width: 62%; background: linear-gradient(90deg, #00ff88, #00ff41); border-radius: 3px; transition: width 0.5s ease;" data-live-id="healthMemoryBar"></div>
                        </div>
                    </div>
                    <div style="margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15);" role="group" aria-labelledby="cpuUsageLabel">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                            <span id="cpuUsageLabel" class="status-label" style="color: #aaa;">üî• CPU Usage</span>
                            <span class="status-value" style="color: #00ff88; font-weight: 600;" data-live-id="healthCpuDisplay" aria-describedby="cpuUsageLabel">28%</span>
                        </div>
                        <div style="width: 100%; height: 6px; background: rgba(0, 255, 136, 0.2); border-radius: 3px; overflow: hidden;" role="progressbar" aria-valuenow="28" aria-valuemin="0" aria-valuemax="100" aria-labelledby="cpuUsageLabel">
                            <div style="height: 100%; width: 28%; background: linear-gradient(90deg, #00ff88, #00ff41); border-radius: 3px; transition: width 0.5s ease;" data-live-id="healthCpuBar"></div>
                        </div>
                    </div>
                    <div class="status-line" style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15);" role="group" aria-labelledby="cpuTempLabel">
                        <span id="cpuTempLabel" class="status-label" style="color: #aaa;">üå°Ô∏è CPU Temperature</span>
                        <span class="status-value" style="color: #00ff88; font-weight: 600;" data-live-id="cpuTempDisplay" aria-describedby="cpuTempLabel">42¬∞C</span>
                    </div>
                    <div class="status-line" style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15);" role="group" aria-labelledby="warningsLabel">
                        <span id="warningsLabel" class="status-label" style="color: #aaa;">‚ö†Ô∏è Active Warnings</span>
                        <span class="status-value" style="color: #00ff88; font-weight: 600;" data-live-id="warningsDisplay" aria-describedby="warningsLabel">0</span>
                    </div>
                    <div class="status-line" style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding: 0.75rem 0;" role="group" aria-labelledby="lastCheckLabel">
                        <span id="lastCheckLabel" class="status-label" style="color: #aaa;">üîç Last Health Check</span>
                        <span class="status-value" style="color: #00ff88; font-weight: 600;" data-live-id="lastCheckDisplay" aria-describedby="lastCheckLabel">Just now</span>
                    </div>
                `;
            }
            
            console.log('‚úÖ System data loaded');
        }
        
        // Setup command input functionality
        function setupCommandInput() {
            const commandInput = document.getElementById('commandInput');
            if (commandInput) {
                console.log('‚úÖ Setting up command input');
                
                commandInput.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        const command = commandInput.value.trim();
                        if (command) {
                            processCommand(command);
                            commandInput.value = '';
                        }
                    }
                });
                
                // Focus the input
                commandInput.focus();
            } else {
                console.error('‚ùå Command input element not found');
            }
        }
        
        // Process terminal commands
        function processCommand(command) {
            console.log('üîß Processing command:', command);
            
            const output = document.getElementById('commandOutput');
            if (!output) {
                console.error('‚ùå Command output element not found');
                return;
            }
            
            // Add command to output
            const commandLine = document.createElement('div');
            commandLine.className = 'command-line';
            commandLine.style.marginBottom = '0.5rem';
            commandLine.style.display = 'flex';
            commandLine.style.alignItems = 'center';
            commandLine.innerHTML = `
                <span style="color: #ff6b35; margin-right: 0.5rem; font-weight: 600;">codexam@system:~$</span>
                <span style="color: #00ff88;">${command}</span>
            `;
            output.appendChild(commandLine);
            
            // Process command
            let response = '';
            switch (command.toLowerCase()) {
                case 'help':
                    response = `Available commands:
  help     - Show this help message
  status   - Show system status
  stats    - Show platform statistics
  health   - Show health monitoring data
  perf     - Show performance metrics
  cache    - Show cache statistics
  time     - Show current system time
  uptime   - Show system uptime
  clear    - Clear terminal output
  users    - Show active users
  problems - Show problem statistics

Cache Management:
  cache clear    - Clear all cached data
  cache stats    - Show detailed cache info
  cache preload  - Preload common data`;
                    break;
                case 'status':
                    response = `=== SYSTEM STATUS ===
Server: OPERATIONAL
Database: CONNECTED
Judge Engine: ONLINE
Uptime: 24h 15m`;
                    break;
                case 'stats':
                    response = `=== PLATFORM STATISTICS ===
Total Problems: 156
Total Submissions: 12,847
Active Users: 42
Success Rate: 68.5%`;
                    break;
                case 'health':
                    response = `=== HEALTH MONITORING ===
System Health: HEALTHY
Memory Status: OPTIMAL
CPU Temperature: 42¬∞C
Active Warnings: 0
Last Health Check: Just now
Response Time: 45ms
Memory Usage: 62%
CPU Usage: 28%`;
                    break;
                case 'performance':
                case 'perf':
                    const memoryInfo = performance.memory ? 
                        `JS Heap: ${(performance.memory.usedJSHeapSize / 1024 / 1024).toFixed(2)}MB` : 
                        'Memory info not available';
                    
                    response = `=== PERFORMANCE METRICS ===
Modal Open Time: ${performanceMetrics.modalOpenTime.toFixed(2)}ms
Data Load Time: ${performanceMetrics.dataLoadTime.toFixed(2)}ms
${memoryInfo}
Animation Frames: ${performanceMetrics.animationFrames}
FPS: ${(1000 / (performanceMetrics.dataLoadTime || 16)).toFixed(1)}

Performance Tips:
- Modal opens in <500ms (target)
- Data updates in <16ms (60fps)
- Memory usage monitored
- Animations optimized for GPU`;
                    break;
                case 'cache':
                    const cacheStats = systemInfoCache.getStats();
                    response = `=== CACHE STATISTICS ===
Hit Rate: ${cacheStats.hitRate}
Cache Hits: ${cacheStats.hits}
Cache Misses: ${cacheStats.misses}
Cache Size: ${cacheStats.cacheSize}/${cacheStats.maxSize}
Evictions: ${cacheStats.evictions}
Compression Ratio: ${(cacheStats.compressionRatio * 100).toFixed(1)}%

Cache Commands:
- cache clear    - Clear all cache
- cache stats    - Show detailed stats
- cache preload  - Preload common data`;
                    break;
                case 'cache clear':
                    systemInfoCache.clear();
                    response = `=== CACHE CLEARED ===
All cached data has been removed.
Next data requests will fetch fresh data from the server.`;
                    break;
                case 'cache stats':
                    const detailedStats = systemInfoCache.getStats();
                    const cacheEntries = [];
                    
                    // Get cache entry details (limited to avoid overwhelming output)
                    let entryCount = 0;
                    for (const [key] of systemInfoCache.cache.entries()) {
                        if (entryCount < 5) {
                            cacheEntries.push(`  ${key}`);
                            entryCount++;
                        }
                    }
                    
                    if (systemInfoCache.cache.size > 5) {
                        cacheEntries.push(`  ... and ${systemInfoCache.cache.size - 5} more`);
                    }
                    
                    response = `=== DETAILED CACHE STATISTICS ===
Performance:
  Hit Rate: ${detailedStats.hitRate}
  Total Requests: ${detailedStats.totalRequests}
  Cache Hits: ${detailedStats.hits}
  Cache Misses: ${detailedStats.misses}

Storage:
  Current Size: ${detailedStats.cacheSize}/${detailedStats.maxSize} entries
  Evictions: ${detailedStats.evictions}
  Compression: ${(detailedStats.compressionRatio * 100).toFixed(1)}% average

Cached Entries:
${cacheEntries.join('\n')}`;
                    break;
                case 'cache preload':
                    // Preload common data
                    const preloadKeys = ['api:system-info', 'api:platform-stats', 'api:health-check'];
                    systemInfoCache.preload(preloadKeys, async (key) => {
                        const endpoint = key.replace('api:', '/api/').replace('-', '-');
                        const response = await fetch(endpoint);
                        return response.json();
                    }).then(() => {
                        console.log('‚úÖ Cache preload completed');
                    }).catch(error => {
                        console.warn('‚ö†Ô∏è Cache preload failed:', error);
                    });
                    
                    response = `=== CACHE PRELOAD INITIATED ===
Preloading common API endpoints:
- System Information
- Platform Statistics  
- Health Check Data

This will improve response times for future requests.`;
                    break;
                case 'time':
                    response = `Current time: ${new Date().toLocaleString()}`;
                    break;
                case 'uptime':
                    response = `System uptime: 24h 15m`;
                    break;
                case 'clear':
                    output.innerHTML = `
                        <div class="command-line" style="margin-bottom: 0.5rem; display: flex; align-items: center;">
                            <span style="color: #ff6b35; margin-right: 0.5rem; font-weight: 600;">codexam@system:~$</span>
                            <span style="color: #00ff88;">Terminal cleared</span>
                        </div>
                    `;
                    output.scrollTop = output.scrollHeight;
                    return;
                case 'users':
                    response = `=== ACTIVE USERS ===
Total registered: 1,247
Currently online: 42
Peak today: 89`;
                    break;
                case 'problems':
                    response = `=== PROBLEM STATISTICS ===
Easy: 62 problems
Medium: 71 problems  
Hard: 23 problems
Most popular: Two Sum`;
                    break;
                default:
                    response = `Command not found: ${command}
Type 'help' for available commands`;
            }
            
            // Add response
            const responseLine = document.createElement('div');
            responseLine.className = 'command-line';
            responseLine.style.marginBottom = '0.5rem';
            responseLine.style.whiteSpace = 'pre-line';
            responseLine.innerHTML = `<span style="color: #00ff88;">${response}</span>`;
            output.appendChild(responseLine);
            
            // Scroll to bottom
            output.scrollTop = output.scrollHeight;
            
            console.log('‚úÖ Command processed:', command);
        }
        
        // Real-time data update system
        let updateInterval = null;
        let previousData = {};
        
        function startRealTimeUpdates() {
            console.log('üîÑ Starting real-time data updates...');
            
            // Update every 5 seconds with API calls
            updateInterval = setInterval(function() {
                updateSystemDataFromAPI();
            }, 5000);
        }
        
        function stopRealTimeUpdates() {
            if (updateInterval) {
                clearInterval(updateInterval);
                updateInterval = null;
                console.log('‚èπÔ∏è Real-time updates stopped');
            }
        }
        
        function updateSystemDataRealTime() {
            const startTime = performance.now();
            console.log('üìä Updating real-time data...');
            
            // Generate new random data
            const newData = {
                uptime: `${Math.floor(Math.random() * 72) + 1}h ${Math.floor(Math.random() * 60)}m`,
                responseTime: `${Math.floor(Math.random() * 50) + 20}ms`,
                memoryUsage: `${Math.floor(Math.random() * 30) + 45}%`,
                cpuUsage: `${Math.floor(Math.random() * 40) + 15}%`,
                activeConnections: Math.floor(Math.random() * 30) + 20,
                activeUsers: Math.floor(Math.random() * 20) + 35,
                totalSubmissions: 12847 + Math.floor(Math.random() * 10),
                // Health monitoring data
                systemHealth: Math.random() > 0.1 ? 'HEALTHY' : 'WARNING',
                memoryStatus: Math.random() > 0.15 ? 'OPTIMAL' : 'HIGH',
                cpuTemp: `${Math.floor(Math.random() * 20) + 35}¬∞C`,
                warnings: Math.random() > 0.8 ? Math.floor(Math.random() * 3) : 0,
                lastCheck: 'Just now'
            };
            
            // Batch DOM updates for better performance
            requestAnimationFrame(() => {
                const updates = [];
                
                // Collect all updates that need to be made
                if (newData.uptime !== previousData.uptime) {
                    updates.push(() => updateElementWithHighlight('uptimeDisplay', newData.uptime, previousData.uptime));
                }
                
                if (newData.activeUsers !== previousData.activeUsers) {
                    updates.push(() => updateElementWithHighlight('activeUsersDisplay', newData.activeUsers, previousData.activeUsers));
                }
                
                if (newData.totalSubmissions !== previousData.totalSubmissions) {
                    updates.push(() => updateElementWithHighlight('totalSubmissionsDisplay', newData.totalSubmissions.toLocaleString(), previousData.totalSubmissions));
                }
                
                if (newData.responseTime !== previousData.responseTime) {
                    updates.push(() => updateElementWithHighlight('responseTimeDisplay', newData.responseTime, previousData.responseTime));
                }
                
                if (newData.memoryUsage !== previousData.memoryUsage) {
                    updates.push(() => updateElementWithHighlight('memoryUsageDisplay', newData.memoryUsage, previousData.memoryUsage));
                    updates.push(() => updateElementWithHighlight('healthMemoryDisplay', newData.memoryUsage, previousData.memoryUsage));
                    updates.push(() => updateProgressBar('healthMemoryBar', parseInt(newData.memoryUsage)));
                }
                
                if (newData.cpuUsage !== previousData.cpuUsage) {
                    updates.push(() => updateElementWithHighlight('cpuUsageDisplay', newData.cpuUsage, previousData.cpuUsage));
                    updates.push(() => updateElementWithHighlight('healthCpuDisplay', newData.cpuUsage, previousData.cpuUsage));
                    updates.push(() => updateProgressBar('healthCpuBar', parseInt(newData.cpuUsage)));
                }
                
                if (newData.activeConnections !== previousData.activeConnections) {
                    updates.push(() => updateElementWithHighlight('connectionsDisplay', newData.activeConnections, previousData.activeConnections));
                }
                
                if (newData.systemHealth !== previousData.systemHealth) {
                    updates.push(() => updateHealthElementWithStatus('systemHealthDisplay', newData.systemHealth, previousData.systemHealth));
                }
                
                if (newData.cpuTemp !== previousData.cpuTemp) {
                    updates.push(() => updateElementWithHighlight('cpuTempDisplay', newData.cpuTemp, previousData.cpuTemp));
                }
                
                if (newData.warnings !== previousData.warnings) {
                    updates.push(() => updateWarningsDisplay('warningsDisplay', newData.warnings, previousData.warnings));
                }
                
                if (newData.lastCheck !== previousData.lastCheck) {
                    updates.push(() => updateElementWithHighlight('lastCheckDisplay', newData.lastCheck, previousData.lastCheck));
                }
                
                // Update health indicator if needed
                if (newData.systemHealth !== previousData.systemHealth || newData.warnings !== previousData.warnings) {
                    updates.push(() => updateHealthIndicator(newData.systemHealth, newData.warnings));
                }
                
                // Execute all updates in a single frame
                updates.forEach(update => update());
                
                // Store previous data for comparison
                previousData = newData;
                
                // Performance monitoring
                const endTime = performance.now();
                performanceMetrics.dataLoadTime = endTime - startTime;
                
                if (performanceMetrics.dataLoadTime > 16) {
                    console.warn(`‚ö†Ô∏è Data update took ${performanceMetrics.dataLoadTime.toFixed(2)}ms (>16ms)`);
                }
            });
        }
        
        function updateElementWithHighlight(elementId, newValue, oldValue) {
            const element = document.querySelector(`[data-live-id="${elementId}"]`);
            if (element && newValue !== oldValue) {
                // Update value
                element.textContent = newValue;
                
                // Add highlight effect
                element.style.transition = 'all 0.3s ease';
                element.style.backgroundColor = 'rgba(0, 255, 136, 0.3)';
                element.style.boxShadow = '0 0 10px rgba(0, 255, 136, 0.5)';
                
                // Remove highlight after 1 second
                setTimeout(() => {
                    element.style.backgroundColor = 'transparent';
                    element.style.boxShadow = 'none';
                }, 1000);
            }
        }
        
        function updateHealthElementWithStatus(elementId, newValue, oldValue) {
            const element = document.querySelector(`[data-live-id="${elementId}"]`);
            if (element && newValue !== oldValue) {
                // Update value
                element.textContent = newValue;
                
                // Set color based on status
                let color = '#00ff88'; // Default green
                let bgColor = 'rgba(0, 255, 136, 0.3)';
                let shadowColor = 'rgba(0, 255, 136, 0.5)';
                
                if (newValue === 'WARNING' || newValue === 'HIGH') {
                    color = '#ffaa00'; // Orange for warnings
                    bgColor = 'rgba(255, 170, 0, 0.3)';
                    shadowColor = 'rgba(255, 170, 0, 0.5)';
                } else if (newValue === 'ERROR' || newValue === 'CRITICAL') {
                    color = '#ff4444'; // Red for errors
                    bgColor = 'rgba(255, 68, 68, 0.3)';
                    shadowColor = 'rgba(255, 68, 68, 0.5)';
                }
                
                element.style.color = color;
                element.style.transition = 'all 0.3s ease';
                element.style.backgroundColor = bgColor;
                element.style.boxShadow = `0 0 10px ${shadowColor}`;
                
                // Remove highlight after 1 second but keep color
                setTimeout(() => {
                    element.style.backgroundColor = 'transparent';
                    element.style.boxShadow = 'none';
                }, 1000);
            }
        }
        
        function updateWarningsDisplay(elementId, newValue, oldValue) {
            const element = document.querySelector(`[data-live-id="${elementId}"]`);
            if (element && newValue !== oldValue) {
                // Update value
                element.textContent = newValue;
                
                // Set color based on warning count
                let color = '#00ff88'; // Green for no warnings
                let bgColor = 'rgba(0, 255, 136, 0.3)';
                let shadowColor = 'rgba(0, 255, 136, 0.5)';
                
                if (newValue > 0) {
                    color = '#ffaa00'; // Orange for warnings
                    bgColor = 'rgba(255, 170, 0, 0.3)';
                    shadowColor = 'rgba(255, 170, 0, 0.5)';
                    
                    // Add pulsing effect for warnings
                    element.style.animation = 'warningPulse 2s ease-in-out infinite';
                } else {
                    element.style.animation = 'none';
                }
                
                element.style.color = color;
                element.style.transition = 'all 0.3s ease';
                element.style.backgroundColor = bgColor;
                element.style.boxShadow = `0 0 10px ${shadowColor}`;
                
                // Remove highlight after 1 second but keep color and animation
                setTimeout(() => {
                    element.style.backgroundColor = 'transparent';
                    element.style.boxShadow = 'none';
                }, 1000);
            }
        }
        
        function updateProgressBar(elementId, percentage) {
            const element = document.querySelector(`[data-live-id="${elementId}"]`);
            if (element) {
                // Update width
                element.style.width = `${percentage}%`;
                
                // Update ARIA attributes for progress bar
                const progressBar = element.parentElement;
                if (progressBar && progressBar.getAttribute('role') === 'progressbar') {
                    progressBar.setAttribute('aria-valuenow', percentage);
                    
                    // Update screen reader announcement
                    const label = progressBar.getAttribute('aria-labelledby');
                    if (label) {
                        const labelElement = document.getElementById(label);
                        if (labelElement) {
                            const labelText = labelElement.textContent;
                            announceToScreenReader(`${labelText} updated to ${percentage}%`);
                        }
                    }
                }
                
                // Change color based on usage level
                let gradient = 'linear-gradient(90deg, #00ff88, #00ff41)'; // Green for normal
                
                if (percentage > 80) {
                    gradient = 'linear-gradient(90deg, #ff4444, #ff6666)'; // Red for high usage
                } else if (percentage > 60) {
                    gradient = 'linear-gradient(90deg, #ffaa00, #ffcc00)'; // Orange for medium usage
                }
                
                element.style.background = gradient;
                
                // Add glow effect for high usage
                if (percentage > 80) {
                    element.style.boxShadow = '0 0 10px rgba(255, 68, 68, 0.6)';
                } else if (percentage > 60) {
                    element.style.boxShadow = '0 0 10px rgba(255, 170, 0, 0.6)';
                } else {
                    element.style.boxShadow = '0 0 5px rgba(0, 255, 136, 0.4)';
                }
            }
        }
        
        function updateHealthIndicator(systemHealth, warnings) {
            const indicator = document.getElementById('healthIndicator');
            if (indicator) {
                // Determine overall health status
                let color = '#00ff88'; // Green for healthy
                let animation = 'pulse 2s ease-in-out infinite';
                
                if (systemHealth === 'WARNING' || warnings > 0) {
                    color = '#ffaa00'; // Orange for warnings
                    animation = 'warningPulse 2s ease-in-out infinite';
                } else if (systemHealth === 'ERROR' || systemHealth === 'CRITICAL') {
                    color = '#ff4444'; // Red for errors
                    animation = 'warningPulse 1s ease-in-out infinite';
                }
                
                indicator.style.color = color;
                indicator.style.animation = animation;
                indicator.style.textShadow = `0 0 10px ${color}`;
            }
        }
        
        // Optimized modal show function
        const originalShow = window.showSystemInfoModal;
        window.showSystemInfoModal = function() {
            const startTime = performance.now();
            performance.mark('systemInfoModal-start');
            
            const result = originalShow();
            if (result) {
                // Optimize modal opening with performance monitoring
                requestAnimationFrame(() => {
                    const modal = document.getElementById('systemInfoModal');
                    if (modal) {
                        // Prepare elements for animation
                        prepareForAnimation(modal);
                        
                        // Lazy load matrix background
                        const matrixBg = modal.querySelector('.matrix-background');
                        if (matrixBg && intersectionObserver) {
                            intersectionObserver.observe(matrixBg);
                        }
                    }
                });
                
                // Show advanced interface after 3 seconds with optimization
                setTimeout(function() {
                    console.log('üîÑ Transitioning to advanced interface...');
                    
                    const bootSequence = document.getElementById('bootSequence');
                    const terminalInterface = document.getElementById('terminalInterface');
                    
                    // Batch DOM operations
                    requestAnimationFrame(() => {
                        if (bootSequence) {
                            bootSequence.style.display = 'none';
                            console.log('‚úÖ Boot sequence hidden');
                        }
                        
                        if (terminalInterface) {
                            terminalInterface.style.display = 'grid';
                            terminalInterface.style.opacity = '1';
                            console.log('‚úÖ Terminal interface shown');
                            
                            // Observe panels for lazy loading
                            const panels = terminalInterface.querySelectorAll('.terminal-panel');
                            if (intersectionObserver) {
                                panels.forEach(panel => {
                                    intersectionObserver.observe(panel);
                                });
                            }
                            
                            // Load data into panels with performance optimization
                            requestIdleCallback(() => {
                                loadSystemData();
                            });
                            
                            // Setup command input
                            setupCommandInput();
                            
                            // Start real-time updates
                            startRealTimeUpdates();
                            
                            // Start visual effects with performance optimization
                            requestIdleCallback(() => {
                                // Only create effects if user prefers motion
                                if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                                    createMatrixEffect();
                                    addProgressiveReveal();
                                    addScanLineEffect();
                                    addParticleEffect();
                                    
                                    // Add optimized glitch effect to ASCII art
                                    const asciiArt = document.querySelector('.ascii-art');
                                    if (asciiArt) {
                                        const glitchInterval = setInterval(() => {
                                            if (Math.random() > 0.95) {
                                                addGlitchEffect(asciiArt);
                                            }
                                            
                                            // Stop if modal is closed
                                            const modal = document.getElementById('systemInfoModal');
                                            if (!modal || modal.style.display === 'none') {
                                                clearInterval(glitchInterval);
                                            }
                                        }, 2000);
                                    }
                                }
                            });
                            
                            // Performance monitoring
                            performance.mark('systemInfoModal-end');
                            performance.measure('systemInfoModal-load', 'systemInfoModal-start', 'systemInfoModal-end');
                            
                            const endTime = performance.now();
                            performanceMetrics.modalOpenTime = endTime - startTime;
                            console.log(`‚ö° Modal opened in ${performanceMetrics.modalOpenTime.toFixed(2)}ms`);
                        }
                    } else {
                        console.error('‚ùå Terminal interface element not found');
                    }
                }, 3000);
            }
            return result;
        };
        
        // Visual Effects System
        let matrixCanvas = null;
        let matrixContext = null;
        let matrixAnimationId = null;
        
        function createMatrixEffect() {
            console.log('üé® Creating matrix background effect...');
            
            const matrixBackground = document.getElementById('matrixBackground');
            if (!matrixBackground) return;
            
            // Create canvas for matrix effect
            matrixCanvas = document.createElement('canvas');
            matrixCanvas.style.position = 'absolute';
            matrixCanvas.style.top = '0';
            matrixCanvas.style.left = '0';
            matrixCanvas.style.width = '100%';
            matrixCanvas.style.height = '100%';
            matrixCanvas.style.opacity = '0.1';
            matrixCanvas.style.pointerEvents = 'none';
            matrixCanvas.style.zIndex = '1';
            
            matrixBackground.appendChild(matrixCanvas);
            matrixContext = matrixCanvas.getContext('2d');
            
            // Set canvas size
            matrixCanvas.width = window.innerWidth;
            matrixCanvas.height = window.innerHeight;
            
            // Matrix characters
            const chars = '01„Ç¢„Ç§„Ç¶„Ç®„Ç™„Ç´„Ç≠„ÇØ„Ç±„Ç≥„Çµ„Ç∑„Çπ„Çª„ÇΩ„Çø„ÉÅ„ÉÑ„ÉÜ„Éà„Éä„Éã„Éå„Éç„Éé„Éè„Éí„Éï„Éò„Éõ„Éû„Éü„É†„É°„É¢„É§„É¶„É®„É©„É™„É´„É¨„É≠„ÉØ„É≤„É≥';
            const charArray = chars.split('');
            
            const fontSize = 14;
            const columns = matrixCanvas.width / fontSize;
            const drops = [];
            
            // Initialize drops
            for (let i = 0; i < columns; i++) {
                drops[i] = 1;
            }
            
            function drawMatrix() {
                // Semi-transparent black background
                matrixContext.fillStyle = 'rgba(0, 0, 0, 0.05)';
                matrixContext.fillRect(0, 0, matrixCanvas.width, matrixCanvas.height);
                
                // Green text
                matrixContext.fillStyle = '#00ff88';
                matrixContext.font = fontSize + 'px monospace';
                
                for (let i = 0; i < drops.length; i++) {
                    const text = charArray[Math.floor(Math.random() * charArray.length)];
                    matrixContext.fillText(text, i * fontSize, drops[i] * fontSize);
                    
                    if (drops[i] * fontSize > matrixCanvas.height && Math.random() > 0.975) {
                        drops[i] = 0;
                    }
                    drops[i]++;
                }
            }
            
            function animateMatrix() {
                drawMatrix();
                matrixAnimationId = requestAnimationFrame(animateMatrix);
            }
            
            animateMatrix();
        }
        
        function stopMatrixEffect() {
            if (matrixAnimationId) {
                cancelAnimationFrame(matrixAnimationId);
                matrixAnimationId = null;
            }
            if (matrixCanvas && matrixCanvas.parentNode) {
                matrixCanvas.parentNode.removeChild(matrixCanvas);
                matrixCanvas = null;
                matrixContext = null;
            }
        }
        
        function addGlitchEffect(element) {
            if (!element) return;
            
            element.style.animation = 'glitch 0.3s ease-in-out';
            
            setTimeout(() => {
                element.style.animation = '';
            }, 300);
        }
        
        function addProgressiveReveal() {
            const panels = document.querySelectorAll('.terminal-panel');
            panels.forEach((panel, index) => {
                panel.style.opacity = '0';
                panel.style.transform = 'translateY(20px)';
                panel.style.transition = 'all 0.6s ease-out';
                
                setTimeout(() => {
                    panel.style.opacity = '1';
                    panel.style.transform = 'translateY(0)';
                }, (index + 1) * 200);
            });
        }
        
        function addScanLineEffect() {
            const terminalInterface = document.getElementById('terminalInterface');
            if (!terminalInterface) return;
            
            // Create scan line element
            const scanLine = document.createElement('div');
            scanLine.style.position = 'absolute';
            scanLine.style.top = '0';
            scanLine.style.left = '0';
            scanLine.style.right = '0';
            scanLine.style.height = '2px';
            scanLine.style.background = 'linear-gradient(90deg, transparent, #00ff88, transparent)';
            scanLine.style.animation = 'scanLine 3s linear infinite';
            scanLine.style.zIndex = '10';
            scanLine.style.pointerEvents = 'none';
            
            terminalInterface.style.position = 'relative';
            terminalInterface.appendChild(scanLine);
        }
        
        function addParticleEffect() {
            const terminalContent = document.querySelector('.terminal-content');
            if (!terminalContent) return;
            
            // Create particles container
            const particlesContainer = document.createElement('div');
            particlesContainer.style.position = 'absolute';
            particlesContainer.style.top = '0';
            particlesContainer.style.left = '0';
            particlesContainer.style.width = '100%';
            particlesContainer.style.height = '100%';
            particlesContainer.style.pointerEvents = 'none';
            particlesContainer.style.zIndex = '1';
            
            terminalContent.style.position = 'relative';
            terminalContent.appendChild(particlesContainer);
            
            // Create floating particles
            for (let i = 0; i < 20; i++) {
                const particle = document.createElement('div');
                particle.style.position = 'absolute';
                particle.style.width = '2px';
                particle.style.height = '2px';
                particle.style.background = '#00ff88';
                particle.style.borderRadius = '50%';
                particle.style.opacity = Math.random() * 0.5 + 0.2;
                particle.style.left = Math.random() * 100 + '%';
                particle.style.top = Math.random() * 100 + '%';
                particle.style.animation = `float ${Math.random() * 10 + 5}s linear infinite`;
                
                particlesContainer.appendChild(particle);
            }
        }
        
        // Health Monitoring System
        function getHealthStatus(value, type) {
            switch (type) {
                case 'percentage':
                    if (value >= 90) return { status: 'critical', color: '#ff4444', icon: 'üî¥' };
                    if (value >= 75) return { status: 'warning', color: '#ffaa00', icon: 'üü°' };
                    if (value >= 50) return { status: 'good', color: '#00ff88', icon: 'üü¢' };
                    return { status: 'excellent', color: '#00ff41', icon: '‚úÖ' };
                
                case 'response_time':
                    const ms = parseInt(value);
                    if (ms >= 100) return { status: 'critical', color: '#ff4444', icon: 'üî¥' };
                    if (ms >= 75) return { status: 'warning', color: '#ffaa00', icon: 'üü°' };
                    if (ms >= 50) return { status: 'good', color: '#00ff88', icon: 'üü¢' };
                    return { status: 'excellent', color: '#00ff41', icon: '‚úÖ' };
                
                case 'connections':
                    if (value >= 80) return { status: 'critical', color: '#ff4444', icon: 'üî¥' };
                    if (value >= 60) return { status: 'warning', color: '#ffaa00', icon: 'üü°' };
                    if (value >= 30) return { status: 'good', color: '#00ff88', icon: 'üü¢' };
                    return { status: 'excellent', color: '#00ff41', icon: '‚úÖ' };
                
                default:
                    return { status: 'good', color: '#00ff88', icon: 'üü¢' };
            }
        }
        
        function createProgressBar(value, maxValue, type) {
            const percentage = Math.min((value / maxValue) * 100, 100);
            const health = getHealthStatus(percentage, type);
            
            return `
                <div style="display: flex; align-items: center; gap: 8px; margin-top: 4px;">
                    <div style="flex: 1; height: 8px; background: rgba(0, 255, 136, 0.2); border-radius: 4px; overflow: hidden;">
                        <div style="height: 100%; background: ${health.color}; width: ${percentage}%; transition: all 0.3s ease; box-shadow: 0 0 8px ${health.color}40;"></div>
                    </div>
                    <span style="color: ${health.color}; font-size: 12px; min-width: 40px;">${health.icon} ${percentage.toFixed(1)}%</span>
                </div>
            `;
        }
        
        function createHealthIndicator(label, value, type, unit = '') {
            const health = getHealthStatus(parseFloat(value), type);
            
            return `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; padding: 0.75rem; border-radius: 6px; background: ${health.color}10; border-left: 3px solid ${health.color}; transition: all 0.3s ease;">
                    <div>
                        <span style="color: #aaa; font-size: 0.9rem;">${label}</span>
                        <div style="color: ${health.color}; font-weight: 600; font-size: 1.1rem; margin-top: 2px;">
                            ${health.icon} ${value}${unit}
                        </div>
                    </div>
                    <div style="text-align: right;">
                        <div style="color: ${health.color}; font-size: 0.8rem; text-transform: uppercase; font-weight: 600;">
                            ${health.status}
                        </div>
                        ${type === 'percentage' ? createProgressBar(parseFloat(value), 100, type) : ''}
                    </div>
                </div>
            `;
        }
        
        function updateHealthMonitoring() {
            console.log('üè• Updating health monitoring displays...');
            
            // Update system status with health indicators
            const statusContent = document.getElementById('systemStatusContent');
            if (statusContent) {
                const dbHealth = Math.random() > 0.95 ? 'warning' : 'good';
                const judgeHealth = Math.random() > 0.98 ? 'warning' : 'good';
                const serverHealth = 'good';
                
                statusContent.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; padding: 0.75rem; border-radius: 6px; background: ${dbHealth === 'good' ? '#00ff8810' : '#ffaa0010'}; border-left: 3px solid ${dbHealth === 'good' ? '#00ff88' : '#ffaa00'};">
                        <span style="color: #aaa;">Database</span>
                        <span style="color: ${dbHealth === 'good' ? '#00ff88' : '#ffaa00'}; font-weight: 600;">
                            ${dbHealth === 'good' ? '‚úÖ' : 'üü°'} ${dbHealth === 'good' ? 'CONNECTED' : 'SLOW'}
                        </span>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; padding: 0.75rem; border-radius: 6px; background: ${judgeHealth === 'good' ? '#00ff8810' : '#ffaa0010'}; border-left: 3px solid ${judgeHealth === 'good' ? '#00ff88' : '#ffaa00'};">
                        <span style="color: #aaa;">Judge Engine</span>
                        <span style="color: ${judgeHealth === 'good' ? '#00ff88' : '#ffaa00'}; font-weight: 600;">
                            ${judgeHealth === 'good' ? '‚úÖ' : 'üü°'} ${judgeHealth === 'good' ? 'ONLINE' : 'BUSY'}
                        </span>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; padding: 0.75rem; border-radius: 6px; background: #00ff8810; border-left: 3px solid #00ff88;">
                        <span style="color: #aaa;">Server</span>
                        <span style="color: #00ff88; font-weight: 600;">‚úÖ OPERATIONAL</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.75rem; border-radius: 6px; background: #00ff8810; border-left: 3px solid #00ff88;">
                        <span style="color: #aaa;">Uptime</span>
                        <span style="color: #00ff88; font-weight: 600;" data-live-id="uptimeDisplay">24h 15m</span>
                    </div>
                `;
            }
            
            // Update performance with health monitoring
            const perfContent = document.getElementById('performanceContent');
            if (perfContent) {
                const responseTime = Math.floor(Math.random() * 50) + 20;
                const memoryUsage = Math.floor(Math.random() * 30) + 45;
                const cpuUsage = Math.floor(Math.random() * 40) + 15;
                const connections = Math.floor(Math.random() * 30) + 20;
                
                perfContent.innerHTML = `
                    ${createHealthIndicator('‚ö° Response Time', responseTime, 'response_time', 'ms')}
                    ${createHealthIndicator('üß† Memory Usage', memoryUsage, 'percentage', '%')}
                    ${createHealthIndicator('üî• CPU Usage', cpuUsage, 'percentage', '%')}
                    ${createHealthIndicator('üîó Active Connections', connections, 'connections')}
                `;
            }
        }
        
        function checkSystemHealth() {
            const issues = [];
            
            // Simulate health checks
            if (Math.random() > 0.9) {
                issues.push({
                    type: 'warning',
                    message: 'High memory usage detected',
                    action: 'Consider restarting services'
                });
            }
            
            if (Math.random() > 0.95) {
                issues.push({
                    type: 'critical',
                    message: 'Database connection slow',
                    action: 'Check database server status'
                });
            }
            
            if (issues.length > 0) {
                showHealthAlert(issues);
            }
        }
        
        function showHealthAlert(issues) {
            const alertContainer = document.querySelector('.terminal-content');
            if (!alertContainer) return;
            
            issues.forEach(issue => {
                const alert = document.createElement('div');
                alert.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: ${issue.type === 'critical' ? '#ff444420' : '#ffaa0020'};
                    border: 1px solid ${issue.type === 'critical' ? '#ff4444' : '#ffaa00'};
                    border-radius: 8px;
                    padding: 15px;
                    color: ${issue.type === 'critical' ? '#ff4444' : '#ffaa00'};
                    font-family: monospace;
                    font-size: 14px;
                    z-index: 1000;
                    animation: slideInRight 0.3s ease-out;
                    max-width: 300px;
                `;
                
                alert.innerHTML = `
                    <div style="font-weight: bold; margin-bottom: 5px;">
                        ${issue.type === 'critical' ? 'üî¥' : 'üü°'} ${issue.type.toUpperCase()} ALERT
                    </div>
                    <div style="margin-bottom: 8px;">${issue.message}</div>
                    <div style="font-size: 12px; opacity: 0.8;">${issue.action}</div>
                `;
                
                alertContainer.appendChild(alert);
                
                // Auto-remove after 5 seconds
                setTimeout(() => {
                    if (alert.parentNode) {
                        alert.style.animation = 'slideOutRight 0.3s ease-out';
                        setTimeout(() => {
                            if (alert.parentNode) {
                                alert.parentNode.removeChild(alert);
                            }
                        }, 300);
                    }
                }, 5000);
            });
        }
        
        // Cache performance monitoring
        const cachePerformanceMonitor = {
            metrics: {
                apiCallsSaved: 0,
                bandwidthSaved: 0,
                responseTimeImprovement: 0
            },
            
            recordCacheHit(dataSize, savedTime) {
                this.metrics.apiCallsSaved++;
                this.metrics.bandwidthSaved += dataSize;
                this.metrics.responseTimeImprovement += savedTime;
            },
            
            getReport() {
                return {
                    ...this.metrics,
                    averageTimeSaved: this.metrics.apiCallsSaved > 0 ? 
                        (this.metrics.responseTimeImprovement / this.metrics.apiCallsSaved).toFixed(2) : 0,
                    bandwidthSavedKB: (this.metrics.bandwidthSaved / 1024).toFixed(2)
                };
            }
        };
        
        // Enhanced hide function to stop updates and effects
        const originalHide = window.hideSystemInfoModal;
        window.hideSystemInfoModal = function() {
            stopRealTimeUpdates();
            stopMatrixEffect();
            
            // Clean up mobile enhancements
            cleanupMobileEnhancements();
            
            // Save cache to storage before closing
            if (systemInfoCache && systemInfoCache.config.persistToStorage) {
                systemInfoCache.saveToStorage();
            }
            
            return originalHide();
        };
        
        function cleanupMobileEnhancements() {
            const modal = document.getElementById('systemInfoModal');
            if (modal) {
                modal.classList.remove('mobile-device', 'keyboard-open');
                modal.style.transform = '';
                modal.style.opacity = '';
            }
        }
        
        // Performance optimization initialization
        function initializePerformanceOptimizations() {
            console.log('‚ö° Initializing performance optimizations...');
            
            // Initialize lazy loading
            initializeLazyLoading();
            
            // Initialize efficient DOM manipulation
            initializeEfficientDOM();
            
            // Initialize animation performance optimization
            initializeAnimationOptimization();
            
            // Initialize memory management
            initializeMemoryManagement();
            
            // Initialize performance monitoring
            initializePerformanceMonitoring();
        }
        
        function initializeLazyLoading() {
            // Lazy load non-critical components
            const modal = document.getElementById('systemInfoModal');
            if (!modal) return;
            
            // Create intersection observer for lazy loading
            if ('IntersectionObserver' in window) {
                intersectionObserver = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const target = entry.target;
                            
                            // Lazy load matrix background
                            if (target.classList.contains('matrix-background')) {
                                loadMatrixBackground(target);
                            }
                            
                            // Lazy load panel content
                            if (target.classList.contains('terminal-panel')) {
                                loadPanelContent(target);
                            }
                            
                            intersectionObserver.unobserve(target);
                        }
                    });
                }, {
                    rootMargin: '50px',
                    threshold: 0.1
                });
            }
        }
        
        function loadMatrixBackground(element) {
            // Only load matrix background when needed
            if (!element.hasChildNodes()) {
                requestIdleCallback(() => {
                    createMatrixEffect(element);
                });
            }
        }
        
        function loadPanelContent(panel) {
            // Lazy load panel animations and effects
            requestIdleCallback(() => {
                panel.classList.add('loaded');
                
                // Add scan line effect only when visible
                if (!panel.querySelector('.scan-line')) {
                    const scanLine = document.createElement('div');
                    scanLine.className = 'scan-line';
                    panel.appendChild(scanLine);
                }
            });
        }
        
        function initializeEfficientDOM() {
            // Create document fragment for batch DOM operations
            window.createBatchUpdate = function(callback) {
                const fragment = document.createDocumentFragment();
                callback(fragment);
                return fragment;
            };
            
            // Debounced DOM updates
            window.debouncedUpdate = debounce(function(updateFunction) {
                requestAnimationFrame(updateFunction);
            }, 16); // ~60fps
            
            // Throttled scroll handling
            window.throttledScroll = throttle(function(scrollFunction) {
                scrollFunction();
            }, 16);
        }
        
        function initializeAnimationOptimization() {
            // Use CSS transforms instead of changing layout properties
            window.optimizedAnimate = function(element, properties, duration = 300) {
                return new Promise((resolve) => {
                    const startTime = performance.now();
                    
                    function animate(currentTime) {
                        const elapsed = currentTime - startTime;
                        const progress = Math.min(elapsed / duration, 1);
                        
                        // Use transform for better performance
                        if (properties.x !== undefined || properties.y !== undefined) {
                            const x = properties.x || 0;
                            const y = properties.y || 0;
                            element.style.transform = `translate3d(${x * progress}px, ${y * progress}px, 0)`;
                        }
                        
                        if (properties.opacity !== undefined) {
                            element.style.opacity = properties.opacity * progress;
                        }
                        
                        if (properties.scale !== undefined) {
                            const scale = 1 + (properties.scale - 1) * progress;
                            element.style.transform = `scale3d(${scale}, ${scale}, 1)`;
                        }
                        
                        if (progress < 1) {
                            animationFrameId = requestAnimationFrame(animate);
                        } else {
                            resolve();
                        }
                    }
                    
                    animationFrameId = requestAnimationFrame(animate);
                });
            };
            
            // Optimize CSS animations with will-change
            window.prepareForAnimation = function(element) {
                element.style.willChange = 'transform, opacity';
                
                // Clean up after animation
                setTimeout(() => {
                    element.style.willChange = 'auto';
                }, 1000);
            };
        }
        
        function initializeMemoryManagement() {
            // Efficient event listener management
            const eventListeners = new Map();
            
            window.addOptimizedEventListener = function(element, event, handler, options = {}) {
                const key = `${element.id || 'anonymous'}-${event}`;
                
                // Remove existing listener if present
                if (eventListeners.has(key)) {
                    const oldHandler = eventListeners.get(key);
                    element.removeEventListener(event, oldHandler);
                }
                
                // Add new listener
                element.addEventListener(event, handler, { passive: true, ...options });
                eventListeners.set(key, handler);
            };
            
            window.removeOptimizedEventListener = function(element, event) {
                const key = `${element.id || 'anonymous'}-${event}`;
                if (eventListeners.has(key)) {
                    const handler = eventListeners.get(key);
                    element.removeEventListener(event, handler);
                    eventListeners.delete(key);
                }
            };
            
            // Memory cleanup on modal close
            const originalHide = window.hideSystemInfoModal;
            window.hideSystemInfoModal = function() {
                // Cancel any pending animations
                if (animationFrameId) {
                    cancelAnimationFrame(animationFrameId);
                    animationFrameId = null;
                }
                
                // Disconnect observers
                if (intersectionObserver) {
                    intersectionObserver.disconnect();
                }
                
                if (performanceObserver) {
                    performanceObserver.disconnect();
                }
                
                // Clear event listeners
                eventListeners.clear();
                
                // Call original hide function
                stopRealTimeUpdates();
                stopMatrixEffect();
                cleanupMobileEnhancements();
                
                return originalHide();
            };
        }
        
        function initializePerformanceMonitoring() {
            // Performance Observer for monitoring
            if ('PerformanceObserver' in window) {
                performanceObserver = new PerformanceObserver((list) => {
                    const entries = list.getEntries();
                    entries.forEach(entry => {
                        if (entry.name.includes('systemInfoModal')) {
                            performanceMetrics[entry.name] = entry.duration;
                        }
                    });
                });
                
                try {
                    performanceObserver.observe({ entryTypes: ['measure', 'navigation'] });
                } catch (e) {
                    console.warn('Performance Observer not fully supported');
                }
            }
            
            // Memory usage monitoring
            if ('memory' in performance) {
                setInterval(() => {
                    performanceMetrics.memoryUsage = performance.memory.usedJSHeapSize;
                }, 5000);
            }
        }
        
        // Utility functions for performance
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }
        
        function throttle(func, limit) {
            let inThrottle;
            return function() {
                const args = arguments;
                const context = this;
                if (!inThrottle) {
                    func.apply(context, args);
                    inThrottle = true;
                    setTimeout(() => inThrottle = false, limit);
                }
            };
        }
        
        // Optimized matrix effect creation
        function createMatrixEffect(container) {
            if (!container || container.hasChildNodes()) return;
            
            const canvas = document.createElement('canvas');
            canvas.width = container.offsetWidth;
            canvas.height = container.offsetHeight;
            canvas.style.position = 'absolute';
            canvas.style.top = '0';
            canvas.style.left = '0';
            canvas.style.pointerEvents = 'none';
            canvas.style.opacity = '0.1';
            
            const ctx = canvas.getContext('2d');
            const chars = '01';
            const fontSize = 14;
            const columns = Math.floor(canvas.width / fontSize);
            const drops = Array(columns).fill(0);
            
            let lastTime = 0;
            const targetFPS = 30; // Reduced FPS for better performance
            const frameInterval = 1000 / targetFPS;
            
            function draw(currentTime) {
                if (currentTime - lastTime < frameInterval) {
                    requestAnimationFrame(draw);
                    return;
                }
                
                lastTime = currentTime;
                
                // Semi-transparent background for trail effect
                ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                ctx.fillStyle = '#00ff41';
                ctx.font = `${fontSize}px monospace`;
                
                for (let i = 0; i < drops.length; i++) {
                    const text = chars[Math.floor(Math.random() * chars.length)];
                    ctx.fillText(text, i * fontSize, drops[i] * fontSize);
                    
                    if (drops[i] * fontSize > canvas.height && Math.random() > 0.975) {
                        drops[i] = 0;
                    }
                    drops[i]++;
                }
                
                // Only continue animation if modal is visible
                const modal = document.getElementById('systemInfoModal');
                if (modal && modal.style.display !== 'none') {
                    requestAnimationFrame(draw);
                }
            }
            
            container.appendChild(canvas);
            requestAnimationFrame(draw);
        }
        
        // Handle screen size changes with performance optimization
        const optimizedResize = throttle(function() {
            const modal = document.getElementById('systemInfoModal');
            if (modal && modal.style.display !== 'none') {
                // Reinitialize mobile enhancements if screen size changed
                const isMobile = window.innerWidth <= 768;
                if (isMobile) {
                    modal.classList.add('mobile-device');
                } else {
                    modal.classList.remove('mobile-device', 'keyboard-open');
                }
                
                // Recalculate matrix effect if needed
                const matrixBg = modal.querySelector('.matrix-background canvas');
                if (matrixBg) {
                    requestIdleCallback(() => {
                        matrixBg.width = modal.offsetWidth;
                        matrixBg.height = modal.offsetHeight;
                    });
                }
            }
        }, 250);
        
        window.addEventListener('resize', optimizedResize, { passive: true });
        
        // Add performance monitoring to window
        window.getModalPerformanceMetrics = function() {
            return {
                ...performanceMetrics,
                timestamp: new Date().toISOString(),
                userAgent: navigator.userAgent,
                viewport: `${window.innerWidth}x${window.innerHeight}`,
                devicePixelRatio: window.devicePixelRatio || 1
            };
        };
        
        // Add performance warning system
        function checkPerformanceWarnings() {
            const warnings = [];
            
            if (performanceMetrics.modalOpenTime > 500) {
                warnings.push('Modal opening is slow (>500ms)');
            }
            
            if (performanceMetrics.dataLoadTime > 16) {
                warnings.push('Data updates are dropping frames (>16ms)');
            }
            
            if (performance.memory && performance.memory.usedJSHeapSize > 50 * 1024 * 1024) {
                warnings.push('High memory usage (>50MB)');
            }
            
            if (warnings.length > 0) {
                console.warn('‚ö†Ô∏è Performance warnings:', warnings);
                
                // Announce to screen reader if function exists
                if (window.announceToScreenReader) {
                    announceToScreenReader(`Performance warning: ${warnings[0]}`);
                }
            }
            
            return warnings;
        }
        
        // Smart cache refresh and performance monitoring
        setInterval(() => {
            const modal = document.getElementById('systemInfoModal');
            if (modal && modal.style.display !== 'none') {
                checkPerformanceWarnings();
                
                // Smart cache refresh based on data importance
                smartCacheRefresh();
            }
        }, 30000);
        
        function smartCacheRefresh() {
            // Refresh critical data more frequently
            const criticalData = ['api:health-check'];
            const normalData = ['api:system-info'];
            const lowPriorityData = ['api:platform-stats'];
            
            // Check if critical data needs refresh (every 15 seconds)
            criticalData.forEach(key => {
                const cached = systemInfoCache.cache.get(key);
                if (cached && (Date.now() - cached.createdAt) > 15000) {
                    systemInfoCache.delete(key);
                    console.log(`üîÑ Smart refresh: invalidated critical data '${key}'`);
                }
            });
            
            // Check if normal data needs refresh (every 30 seconds)
            normalData.forEach(key => {
                const cached = systemInfoCache.cache.get(key);
                if (cached && (Date.now() - cached.createdAt) > 30000) {
                    systemInfoCache.delete(key);
                    console.log(`üîÑ Smart refresh: invalidated normal data '${key}'`);
                }
            });
            
            // Low priority data refreshes less frequently (every 60 seconds)
            lowPriorityData.forEach(key => {
                const cached = systemInfoCache.cache.get(key);
                if (cached && (Date.now() - cached.createdAt) > 60000) {
                    systemInfoCache.delete(key);
                    console.log(`üîÑ Smart refresh: invalidated low priority data '${key}'`);
                }
            });
        }
        
        // Add cache warming on modal open
        const originalShow = window.showSystemInfoModal;
        window.showSystemInfoModal = function() {
            const result = originalShow.apply(this, arguments);
            
            // Warm up cache with commonly accessed data
            if (result) {
                requestIdleCallback(() => {
                    warmUpCache();
                });
            }
            
            return result;
        };
        
        function warmUpCache() {
            console.log('üî• Warming up cache...');
            
            // Preload data that's likely to be accessed
            const commonEndpoints = [
                { key: 'api:system-info', url: '/api/system-info', ttl: 30000 },
                { key: 'api:platform-stats', url: '/api/platform-stats', ttl: 60000 },
                { key: 'api:health-check', url: '/api/health-check', ttl: 15000 }
            ];
            
            commonEndpoints.forEach(async ({ key, url, ttl }) => {
                if (!systemInfoCache.has(key)) {
                    try {
                        const response = await fetch(url);
                        const data = await response.json();
                        systemInfoCache.set(key, data, ttl);
                        console.log(`üî• Warmed up cache for '${key}'`);
                    } catch (error) {
                        console.warn(`‚ö†Ô∏è Failed to warm up cache for '${key}':`, error);
                    }
                }
            });
        }
        
        // Performance optimization variables
        let performanceMetrics = {
            modalOpenTime: 0,
            dataLoadTime: 0,
            animationFrames: 0,
            memoryUsage: 0
        };
        
        let animationFrameId = null;
        let performanceObserver = null;
        let intersectionObserver = null;
        
        // DOM ready check with performance monitoring
        document.addEventListener('DOMContentLoaded', function() {
            console.log('‚úÖ Clean modal script loaded');
            console.log('‚úÖ Modal element exists:', !!document.getElementById('systemInfoModal'));
            console.log('‚úÖ Both buttons should now work!');
            console.log('üí° Modal will show boot sequence for 3 seconds, then advanced interface');
            
            // Initialize performance optimizations
            initializePerformanceOptimizations();
            
            // Initialize mobile enhancements
            initializeMobileEnhancements();
        });
        
        // Mobile-specific enhancements
        function initializeMobileEnhancements() {
            console.log('üì± Initializing mobile enhancements...');
            
            // Detect mobile device
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || 
                           window.innerWidth <= 768;
            
            if (isMobile) {
                console.log('üì± Mobile device detected');
                
                // Add mobile class to modal
                const modal = document.getElementById('systemInfoModal');
                if (modal) {
                    modal.classList.add('mobile-device');
                }
                
                // Prevent zoom on input focus (iOS)
                const commandInput = document.getElementById('commandInput');
                if (commandInput) {
                    commandInput.style.fontSize = '16px'; // Prevents zoom on iOS
                }
                
                // Add touch event handlers
                addTouchEventHandlers();
                
                // Optimize for mobile viewport
                optimizeMobileViewport();
                
                // Add mobile-specific keyboard handling
                addMobileKeyboardHandling();
                
                // Add mobile accessibility enhancements
                addMobileAccessibility();
            }
        }
        
        function addTouchEventHandlers() {
            const modal = document.getElementById('systemInfoModal');
            if (!modal) return;
            
            // Add touch-friendly close gesture (swipe down from top)
            let startY = 0;
            let currentY = 0;
            let isDragging = false;
            
            modal.addEventListener('touchstart', function(e) {
                if (e.touches.length === 1 && e.touches[0].clientY < 100) {
                    startY = e.touches[0].clientY;
                    isDragging = true;
                }
            }, { passive: true });
            
            modal.addEventListener('touchmove', function(e) {
                if (!isDragging) return;
                
                currentY = e.touches[0].clientY;
                const deltaY = currentY - startY;
                
                if (deltaY > 0) {
                    // Add visual feedback for swipe down
                    modal.style.transform = `translateY(${Math.min(deltaY * 0.5, 50)}px)`;
                    modal.style.opacity = Math.max(1 - (deltaY / 300), 0.7);
                }
            }, { passive: true });
            
            modal.addEventListener('touchend', function(e) {
                if (!isDragging) return;
                
                const deltaY = currentY - startY;
                
                if (deltaY > 100) {
                    // Close modal if swiped down enough
                    hideSystemInfoModal();
                } else {
                    // Reset position
                    modal.style.transform = '';
                    modal.style.opacity = '';
                }
                
                isDragging = false;
                startY = 0;
                currentY = 0;
            }, { passive: true });
            
            // Add haptic feedback for touch interactions (if supported)
            const closeBtn = document.querySelector('.terminal-close-btn');
            if (closeBtn && 'vibrate' in navigator) {
                closeBtn.addEventListener('touchstart', function() {
                    navigator.vibrate(50); // Short vibration
                }, { passive: true });
            }
        }
        
        function optimizeMobileViewport() {
            // Ensure proper viewport handling
            let viewportMeta = document.querySelector('meta[name="viewport"]');
            if (!viewportMeta) {
                viewportMeta = document.createElement('meta');
                viewportMeta.name = 'viewport';
                document.head.appendChild(viewportMeta);
            }
            
            // Set mobile-optimized viewport
            viewportMeta.content = 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover';
            
            // Handle orientation changes
            window.addEventListener('orientationchange', function() {
                setTimeout(function() {
                    // Recalculate modal dimensions after orientation change
                    const modal = document.getElementById('systemInfoModal');
                    if (modal && modal.style.display !== 'none') {
                        modal.style.height = '100vh';
                        modal.style.height = '100dvh';
                    }
                }, 100);
            });
            
            // Handle safe area insets for devices with notches
            if (CSS.supports('padding-top: env(safe-area-inset-top)')) {
                const modal = document.getElementById('systemInfoModal');
                if (modal) {
                    modal.style.paddingTop = 'env(safe-area-inset-top)';
                    modal.style.paddingBottom = 'env(safe-area-inset-bottom)';
                    modal.style.paddingLeft = 'env(safe-area-inset-left)';
                    modal.style.paddingRight = 'env(safe-area-inset-right)';
                }
            }
        }
        
        function addMobileKeyboardHandling() {
            const commandInput = document.getElementById('commandInput');
            if (!commandInput) return;
            
            // Handle virtual keyboard appearance
            let initialViewportHeight = window.innerHeight;
            
            window.addEventListener('resize', function() {
                const currentHeight = window.innerHeight;
                const heightDifference = initialViewportHeight - currentHeight;
                
                // If height decreased significantly, keyboard is likely open
                if (heightDifference > 150) {
                    const modal = document.getElementById('systemInfoModal');
                    if (modal) {
                        modal.classList.add('keyboard-open');
                        
                        // Scroll command input into view
                        setTimeout(() => {
                            commandInput.scrollIntoView({ 
                                behavior: 'smooth', 
                                block: 'center' 
                            });
                        }, 100);
                    }
                } else {
                    const modal = document.getElementById('systemInfoModal');
                    if (modal) {
                        modal.classList.remove('keyboard-open');
                    }
                }
            });
            
            // Add mobile-friendly command suggestions
            addMobileCommandSuggestions();
        }
        
        function addMobileCommandSuggestions() {
            const commandInput = document.getElementById('commandInput');
            if (!commandInput) return;
            
            // Create suggestion buttons for common commands
            const suggestions = ['help', 'status', 'stats', 'health', 'clear'];
            const suggestionsContainer = document.createElement('div');
            suggestionsContainer.className = 'mobile-command-suggestions';
            suggestionsContainer.style.cssText = `
                display: flex;
                flex-wrap: wrap;
                gap: 0.5rem;
                margin-top: 0.5rem;
                padding: 0.5rem 0;
            `;
            
            suggestions.forEach(cmd => {
                const btn = document.createElement('button');
                btn.textContent = cmd;
                btn.className = 'suggestion-btn';
                btn.style.cssText = `
                    background: rgba(0, 255, 136, 0.2);
                    border: 1px solid rgba(0, 255, 136, 0.4);
                    color: #00ff88;
                    padding: 0.4rem 0.8rem;
                    border-radius: 4px;
                    font-size: 0.8rem;
                    font-family: inherit;
                    cursor: pointer;
                    transition: all 0.3s ease;
                    min-height: 44px;
                    min-width: 60px;
                `;
                
                btn.addEventListener('click', function() {
                    commandInput.value = cmd;
                    commandInput.focus();
                    
                    // Trigger command execution on mobile
                    if (window.innerWidth <= 768) {
                        setTimeout(() => {
                            processCommand(cmd);
                            commandInput.value = '';
                        }, 100);
                    }
                    
                    // Add visual feedback
                    btn.style.background = 'rgba(0, 255, 136, 0.4)';
                    setTimeout(() => {
                        btn.style.background = 'rgba(0, 255, 136, 0.2)';
                    }, 200);
                });
                
                btn.addEventListener('touchstart', function() {
                    if ('vibrate' in navigator) {
                        navigator.vibrate(30);
                    }
                }, { passive: true });
                
                suggestionsContainer.appendChild(btn);
            });
            
            // Insert suggestions after command input container
            const inputContainer = commandInput.closest('.command-input-container');
            if (inputContainer && inputContainer.parentNode) {
                inputContainer.parentNode.insertBefore(suggestionsContainer, inputContainer.nextSibling);
            }
        }
        
        // Comprehensive accessibility enhancements
        function addMobileAccessibility() {
            const modal = document.getElementById('systemInfoModal');
            if (!modal) return;
            
            // Add screen reader announcements
            const announceElement = document.createElement('div');
            announceElement.setAttribute('aria-live', 'polite');
            announceElement.setAttribute('aria-atomic', 'true');
            announceElement.className = 'sr-only accessibility-announcer';
            announceElement.style.cssText = `
                position: absolute !important;
                width: 1px !important;
                height: 1px !important;
                padding: 0 !important;
                margin: -1px !important;
                overflow: hidden !important;
                clip: rect(0, 0, 0, 0) !important;
                white-space: nowrap !important;
                border: 0 !important;
            `;
            modal.appendChild(announceElement);
            
            // Global announce function
            window.announceToScreenReader = function(message, priority = 'polite') {
                if (announceElement) {
                    announceElement.setAttribute('aria-live', priority);
                    announceElement.textContent = message;
                    setTimeout(() => {
                        announceElement.textContent = '';
                        announceElement.setAttribute('aria-live', 'polite');
                    }, 1000);
                }
            };
            
            // Initialize comprehensive accessibility features
            initializeAccessibilityFeatures();
        }
        
        function initializeAccessibilityFeatures() {
            console.log('‚ôø Initializing comprehensive accessibility features...');
            
            // Add keyboard navigation
            addKeyboardNavigation();
            
            // Add focus management
            addFocusManagement();
            
            // Add screen reader enhancements
            addScreenReaderEnhancements();
            
            // Add high contrast mode support
            addHighContrastSupport();
            
            // Add reduced motion support
            addReducedMotionSupport();
        }
        
        function addKeyboardNavigation() {
            const modal = document.getElementById('systemInfoModal');
            if (!modal) return;
            
            // Enhanced keyboard event handler
            modal.addEventListener('keydown', function(e) {
                switch(e.key) {
                    case 'Escape':
                        e.preventDefault();
                        hideSystemInfoModal();
                        announceToScreenReader('System information modal closed');
                        break;
                        
                    case 'Tab':
                        handleTabNavigation(e);
                        break;
                        
                    case 'F6':
                        e.preventDefault();
                        cycleThroughPanels();
                        break;
                        
                    case 'Home':
                        if (e.ctrlKey) {
                            e.preventDefault();
                            focusFirstElement();
                        }
                        break;
                        
                    case 'End':
                        if (e.ctrlKey) {
                            e.preventDefault();
                            focusLastElement();
                        }
                        break;
                        
                    case 'ArrowUp':
                    case 'ArrowDown':
                        if (e.target.id !== 'commandInput') {
                            handleArrowNavigation(e);
                        }
                        break;
                }
            });
            
            // Add keyboard shortcuts help
            addKeyboardShortcutsHelp();
        }
        
        function handleTabNavigation(e) {
            const modal = document.getElementById('systemInfoModal');
            const focusableElements = modal.querySelectorAll(
                'button:not([disabled]), [href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex="-1"])'
            );
            
            const firstElement = focusableElements[0];
            const lastElement = focusableElements[focusableElements.length - 1];
            
            if (e.shiftKey) {
                if (document.activeElement === firstElement) {
                    e.preventDefault();
                    lastElement.focus();
                    announceToScreenReader('Moved to last focusable element');
                }
            } else {
                if (document.activeElement === lastElement) {
                    e.preventDefault();
                    firstElement.focus();
                    announceToScreenReader('Moved to first focusable element');
                }
            }
        }
        
        function cycleThroughPanels() {
            const panels = document.querySelectorAll('.terminal-panel');
            const currentPanel = document.activeElement.closest('.terminal-panel');
            
            if (currentPanel) {
                const currentIndex = Array.from(panels).indexOf(currentPanel);
                const nextIndex = (currentIndex + 1) % panels.length;
                const nextPanel = panels[nextIndex];
                
                // Focus first focusable element in next panel
                const focusableInPanel = nextPanel.querySelector('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
                if (focusableInPanel) {
                    focusableInPanel.focus();
                    const panelTitle = nextPanel.querySelector('h2').textContent;
                    announceToScreenReader(`Moved to ${panelTitle} panel`);
                }
            }
        }
        
        function handleArrowNavigation(e) {
            const currentElement = document.activeElement;
            const panel = currentElement.closest('.terminal-panel');
            
            if (panel) {
                const focusableInPanel = panel.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
                const currentIndex = Array.from(focusableInPanel).indexOf(currentElement);
                
                if (e.key === 'ArrowDown' && currentIndex < focusableInPanel.length - 1) {
                    e.preventDefault();
                    focusableInPanel[currentIndex + 1].focus();
                } else if (e.key === 'ArrowUp' && currentIndex > 0) {
                    e.preventDefault();
                    focusableInPanel[currentIndex - 1].focus();
                }
            }
        }
        
        function focusFirstElement() {
            const modal = document.getElementById('systemInfoModal');
            const firstFocusable = modal.querySelector('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
            if (firstFocusable) {
                firstFocusable.focus();
                announceToScreenReader('Moved to first element');
            }
        }
        
        function focusLastElement() {
            const modal = document.getElementById('systemInfoModal');
            const focusableElements = modal.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
            const lastFocusable = focusableElements[focusableElements.length - 1];
            if (lastFocusable) {
                lastFocusable.focus();
                announceToScreenReader('Moved to last element');
            }
        }
        
        function addFocusManagement() {
            const modal = document.getElementById('systemInfoModal');
            let previousActiveElement = null;
            
            // Store previous focus when modal opens
            const originalShow = window.showSystemInfoModal;
            window.showSystemInfoModal = function() {
                previousActiveElement = document.activeElement;
                const result = originalShow.apply(this, arguments);
                
                // Set initial focus
                setTimeout(() => {
                    const commandInput = document.getElementById('commandInput');
                    if (commandInput) {
                        commandInput.focus();
                        announceToScreenReader('System information modal opened. Terminal command input focused. Press F6 to navigate between panels, or type help for commands.');
                    }
                }, 100);
                
                return result;
            };
            
            // Restore previous focus when modal closes
            const originalHide = window.hideSystemInfoModal;
            window.hideSystemInfoModal = function() {
                const result = originalHide.apply(this, arguments);
                
                if (previousActiveElement && typeof previousActiveElement.focus === 'function') {
                    setTimeout(() => {
                        try {
                            previousActiveElement.focus();
                        } catch (error) {
                            console.warn('Could not restore focus to previous element');
                        }
                    }, 100);
                }
                
                return result;
            };
        }
        
        function addScreenReaderEnhancements() {
            // Enhance command processing with announcements
            const originalProcessCommand = window.processCommand;
            if (originalProcessCommand) {
                window.processCommand = function(command) {
                    announceToScreenReader(`Executing command: ${command}`);
                    const result = originalProcessCommand.apply(this, arguments);
                    
                    setTimeout(() => {
                        announceToScreenReader(`Command ${command} completed. Check output above.`);
                    }, 500);
                    
                    return result;
                };
            }
            
            // Add live region updates for data changes
            const originalUpdateElementWithHighlight = window.updateElementWithHighlight;
            if (originalUpdateElementWithHighlight) {
                window.updateElementWithHighlight = function(elementId, newValue, oldValue) {
                    const result = originalUpdateElementWithHighlight.apply(this, arguments);
                    
                    if (newValue !== oldValue) {
                        const element = document.querySelector(`[data-live-id="${elementId}"]`);
                        if (element) {
                            const label = element.closest('.status-line, .stat-item, .metric-item')?.querySelector('.status-label, .stat-label, .metric-label')?.textContent;
                            if (label) {
                                announceToScreenReader(`${label} updated to ${newValue}`);
                            }
                        }
                    }
                    
                    return result;
                };
            }
        }
        
        function addHighContrastSupport() {
            // Detect high contrast mode
            if (window.matchMedia('(prefers-contrast: high)').matches) {
                document.body.classList.add('high-contrast-mode');
                announceToScreenReader('High contrast mode detected and applied');
            }
            
            // Listen for contrast preference changes
            window.matchMedia('(prefers-contrast: high)').addEventListener('change', function(e) {
                if (e.matches) {
                    document.body.classList.add('high-contrast-mode');
                    announceToScreenReader('High contrast mode enabled');
                } else {
                    document.body.classList.remove('high-contrast-mode');
                    announceToScreenReader('High contrast mode disabled');
                }
            });
        }
        
        function addReducedMotionSupport() {
            // Detect reduced motion preference
            if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.body.classList.add('reduced-motion');
                announceToScreenReader('Reduced motion mode detected and applied');
            }
            
            // Listen for motion preference changes
            window.matchMedia('(prefers-reduced-motion: reduce)').addEventListener('change', function(e) {
                if (e.matches) {
                    document.body.classList.add('reduced-motion');
                    announceToScreenReader('Reduced motion mode enabled');
                } else {
                    document.body.classList.remove('reduced-motion');
                    announceToScreenReader('Reduced motion mode disabled');
                }
            });
        }
        
        function addKeyboardShortcutsHelp() {
            // Add keyboard shortcuts to help command
            const originalProcessCommand = window.processCommand;
            if (originalProcessCommand) {
                window.processCommand = function(command) {
                    if (command.toLowerCase() === 'help') {
                        const output = document.getElementById('commandOutput');
                        if (output) {
                            // Call original help first
                            originalProcessCommand.apply(this, arguments);
                            
                            // Add keyboard shortcuts section
                            const shortcutsLine = document.createElement('div');
                            shortcutsLine.className = 'command-line';
                            shortcutsLine.style.marginBottom = '0.5rem';
                            shortcutsLine.style.whiteSpace = 'pre-line';
                            shortcutsLine.innerHTML = `<span style="color: #00ff88;">
Keyboard Shortcuts:
  Escape   - Close modal
  Tab      - Navigate between elements
  F6       - Cycle through panels
  Ctrl+Home - Focus first element
  Ctrl+End  - Focus last element
  ‚Üë/‚Üì      - Navigate within panels</span>`;
                            output.appendChild(shortcutsLine);
                            output.scrollTop = output.scrollHeight;
                        }
                    } else {
                        originalProcessCommand.apply(this, arguments);
                    }
                };
            }
        }
    </script>
    
    <style>
        /* Visual Effects CSS Animations */
        @keyframes glitch {
            0% { 
                transform: translate(0);
                filter: hue-rotate(0deg);
            }
            20% { 
                transform: translate(-2px, 2px);
                filter: hue-rotate(90deg);
            }
            40% { 
                transform: translate(-2px, -2px);
                filter: hue-rotate(180deg);
            }
            60% { 
                transform: translate(2px, 2px);
                filter: hue-rotate(270deg);
            }
            80% { 
                transform: translate(2px, -2px);
                filter: hue-rotate(360deg);
            }
            100% { 
                transform: translate(0);
                filter: hue-rotate(0deg);
            }
        }
        
        @keyframes scanLine {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        @keyframes float {
            0% { 
                transform: translateY(0px) rotate(0deg);
                opacity: 0.2;
            }
            50% { 
                transform: translateY(-20px) rotate(180deg);
                opacity: 0.8;
            }
            100% { 
                transform: translateY(0px) rotate(360deg);
                opacity: 0.2;
            }
        }
        
        @keyframes terminalPulse {
            0%, 100% { 
                box-shadow: 0 0 5px rgba(0, 255, 136, 0.3);
            }
            50% { 
                box-shadow: 0 0 20px rgba(0, 255, 136, 0.8);
            }
        }
        
        @keyframes warningPulse {
            0%, 100% { 
                text-shadow: 0 0 8px rgba(255, 170, 0, 0.3);
                transform: scale(1);
            }
            50% { 
                text-shadow: 0 0 15px rgba(255, 170, 0, 0.8);
                transform: scale(1.05);
            }
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Health monitoring panel styles */
        .health-panel .panel-indicator {
            animation: pulse 2s ease-in-out infinite;
        }
        
        .health-panel .status-warning {
            color: #ffaa00 !important;
            animation: warningPulse 2s ease-in-out infinite;
        }
        
        .health-panel .status-error {
            color: #ff4444 !important;
            animation: warningPulse 1s ease-in-out infinite;
        }
        
        /* Enhanced panel effects */
        .terminal-panel {
            animation: fadeInUp 0.6s ease-out;
            position: relative;
            overflow: hidden;
        }
        
        .terminal-panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, transparent, #00ff88, transparent);
            animation: scanLine 3s linear infinite;
        }
        
        .terminal-panel:hover {
            animation: terminalPulse 2s ease-in-out infinite;
        }
        
        /* ASCII art glow effect */
        .ascii-art {
            animation: terminalPulse 3s ease-in-out infinite alternate;
        }
        
        /* Command line typing effect */
        .command-line {
            animation: fadeInUp 0.3s ease-out;
        }
        
        /* Status indicators pulse */
        .panel-status, .panel-refresh, .panel-indicator {
            animation: terminalPulse 2s ease-in-out infinite;
        }
        
        /* Matrix background container */
        .matrix-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }
        
        /* Terminal content layering */
        .terminal-content {
            position: relative;
            z-index: 2;
        }
    </style>
    <script>
        // Debug helper for System Info Modal
        function debugSystemInfoModal() {
            console.log('üîß Debug System Info Modal');
            console.log('SystemInfoModal exists:', typeof SystemInfoModal !== 'undefined');
            console.log('Modal element exists:', !!document.getElementById('systemInfoModal'));
            
            if (typeof SystemInfoModal !== 'undefined') {
                console.log('Modal state:', {
                    isOpen: SystemInfoModal.isOpen,
                    isAnimating: SystemInfoModal.isAnimating
                });
            }
        }
        
        // Add to global scope for console debugging
        window.debugSystemInfoModal = debugSystemInfoModal;
        
        // Emergency test function - call this from browser console
        window.emergencyTestModal = function() {
            console.log('üö® EMERGENCY TEST - Forcing modal to show');
            
            // Find modal
            const modal = document.getElementById('systemInfoModal');
            console.log('Modal found:', !!modal);
            
            if (modal) {
                // Force show with brute force
                modal.setAttribute('style', 'display: flex !important; position: fixed !important; top: 0 !important; left: 0 !important; width: 100vw !important; height: 100vh !important; background: rgba(0,0,0,0.95) !important; z-index: 99999 !important; visibility: visible !important; opacity: 1 !important;');
                modal.classList.add('show');
                document.body.style.overflow = 'hidden';
                
                console.log('‚úÖ EMERGENCY: Modal forced to show');
                console.log('Current styles:', modal.getAttribute('style'));
                
                // Auto-hide after 5 seconds
                setTimeout(() => {
                    modal.style.display = 'none';
                    document.body.style.overflow = '';
                    console.log('‚úÖ EMERGENCY: Modal auto-hidden');
                }, 5000);
                
                return true;
            } else {
                console.error('‚ùå EMERGENCY: Modal element not found!');
                return false;
            }
        };
        
        // CLEAN, SIMPLE MODAL FUNCTION - GUARANTEED TO WORK
        window.showSystemInfoModal = function() {
            console.log('üöÄ showSystemInfoModal() called');
            
            const modal = document.getElementById('systemInfoModal');
            if (!modal) {
                console.error('‚ùå Modal not found!');
                alert('ERROR: Modal element not found!');
                return false;
            }
            
            console.log('‚úÖ Modal found, showing...');
            
            // Simple, direct approach
            modal.style.display = 'flex';
            modal.style.visibility = 'visible';
            modal.style.opacity = '1';
            modal.style.zIndex = '99999';
            modal.classList.add('show');
            document.body.style.overflow = 'hidden';
            
            console.log('‚úÖ Modal should be visible now');
            return true;
        };
        
        // SIMPLE HIDE FUNCTION
        window.hideSystemInfoModal = function() {
            console.log('üîß hideSystemInfoModal() called');
            
            const modal = document.getElementById('systemInfoModal');
            if (modal) {
                modal.style.display = 'none';
                modal.classList.remove('show');
                document.body.style.overflow = '';
                
                // Stop statistics updates
                if (typeof SystemStatsVisualizer !== 'undefined') {
                    SystemStatsVisualizer.stopUpdates();
                    console.log('‚úÖ Statistics visualizer stopped');
                }
                
                console.log('‚úÖ Modal hidden');
            }
        };
        
        // Add escape key handler
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                const modal = document.getElementById('systemInfoModal');
                if (modal && modal.style.display !== 'none') {
                    hideSystemInfoModal();
                }
            }
        });
        
        // Update dynamic values in the modal
        function updateSystemMetrics() {
            // Update uptime in both locations
            const uptimeElement = document.getElementById('uptimeDisplay');
            const uptimeElement2 = document.getElementById('uptimeDisplay2');
            const uptime = Math.floor(Math.random() * 72) + 1; // 1-72 hours
            const uptimeText = `${uptime}h ${Math.floor(Math.random() * 60)}m`;
            
            if (uptimeElement) uptimeElement.textContent = uptimeText;
            if (uptimeElement2) uptimeElement2.textContent = uptimeText;
            
            // Update performance metrics with realistic values
            const responseTime = document.getElementById('responseTime');
            const memoryUsage = document.getElementById('memoryUsage');
            const cpuUsage = document.getElementById('cpuUsage');
            const connections = document.getElementById('connections');
            
            const responseTime2 = document.getElementById('responseTime2');
            const memoryUsage2 = document.getElementById('memoryUsage2');
            const cpuUsage2 = document.getElementById('cpuUsage2');
            const connections2 = document.getElementById('connections2');
            
            const responseTimeValue = `${Math.floor(Math.random() * 50) + 20}ms`;
            const memoryUsageValue = `${Math.floor(Math.random() * 30) + 45}%`;
            const cpuUsageValue = `${Math.floor(Math.random() * 40) + 15}%`;
            const connectionsValue = `${Math.floor(Math.random() * 30) + 20}`;
            
            if (responseTime) responseTime.textContent = responseTimeValue;
            if (memoryUsage) memoryUsage.textContent = memoryUsageValue;
            if (cpuUsage) cpuUsage.textContent = cpuUsageValue;
            if (connections) connections.textContent = connectionsValue;
            
            if (responseTime2) responseTime2.textContent = responseTimeValue;
            if (memoryUsage2) memoryUsage2.textContent = memoryUsageValue;
            if (cpuUsage2) cpuUsage2.textContent = cpuUsageValue;
            if (connections2) connections2.textContent = connectionsValue;
        }
        
        // REMOVED COMPLEX OVERWRITE - KEEPING IT SIMPLE
        
        // REMOVED COMPLEX FUNCTIONS - KEEPING IT SIMPLE
        
        // Boot sequence function
        function startBootSequence() {
            console.log('üöÄ Starting boot sequence...');
            
            const bootSequence = document.getElementById('bootSequence');
            const terminalInterface = document.getElementById('terminalInterface');
            
            console.log('Boot sequence element:', !!bootSequence);
            console.log('Terminal interface element:', !!terminalInterface);
            
            // Ensure boot sequence is visible
            if (bootSequence) {
                bootSequence.style.display = 'block';
                bootSequence.style.opacity = '1';
            }
            
            // Ensure terminal interface is hidden initially
            if (terminalInterface) {
                terminalInterface.style.display = 'none';
                terminalInterface.style.opacity = '0';
            }
            
            // Load system data immediately (don't wait for transition)
            loadSystemData();
            
            // Show terminal interface after 4 seconds with smooth transition
            setTimeout(() => {
                console.log('üîÑ Transitioning to terminal interface...');
                
                try {
                    if (bootSequence) {
                        bootSequence.style.opacity = '0';
                        bootSequence.style.transition = 'opacity 0.5s ease-out';
                        
                        setTimeout(() => {
                            bootSequence.style.display = 'none';
                        }, 500);
                    }
                    
                    if (terminalInterface) {
                        terminalInterface.style.display = 'grid';
                        terminalInterface.style.opacity = '0';
                        terminalInterface.style.transition = 'opacity 0.5s ease-in';
                        
                        // Force reflow
                        terminalInterface.offsetHeight;
                        
                        setTimeout(() => {
                            terminalInterface.style.opacity = '1';
                        }, 50);
                    }
                    
                    // Setup command input after transition
                    setTimeout(() => {
                        setupCommandInput();
                        console.log('‚úÖ Terminal interface ready');
                    }, 600);
                    
                } catch (error) {
                    console.error('‚ùå Error during transition:', error);
                    
                    // Fallback: show terminal interface immediately
                    if (bootSequence) bootSequence.style.display = 'none';
                    if (terminalInterface) {
                        terminalInterface.style.display = 'grid';
                        terminalInterface.style.opacity = '1';
                    }
                    setupCommandInput();
                }
                
            }, 4000);
        }
        
        // Load system data into panels
        function loadSystemData() {
            console.log('üìä Loading system data into panels...');
            
            try {
                // Load system status
                const statusContent = document.getElementById('systemStatusContent');
                if (statusContent) {
                    console.log('‚úÖ Loading system status panel');
                    statusContent.innerHTML = `
                        <div class="status-line" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15); transition: all 0.3s ease;">
                            <span class="status-label" style="color: #aaa; font-weight: 500; font-size: 0.9rem;">Database</span>
                            <span class="status-value status-success" style="color: #00ff88; font-weight: 600; text-shadow: 0 0 8px rgba(0, 255, 136, 0.3);">‚úÖ CONNECTED</span>
                        </div>
                        <div class="status-line" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15); transition: all 0.3s ease;">
                            <span class="status-label" style="color: #aaa; font-weight: 500; font-size: 0.9rem;">Judge Engine</span>
                            <span class="status-value status-success" style="color: #00ff88; font-weight: 600; text-shadow: 0 0 8px rgba(0, 255, 136, 0.3);">‚úÖ ONLINE</span>
                        </div>
                        <div class="status-line" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15); transition: all 0.3s ease;">
                            <span class="status-label" style="color: #aaa; font-weight: 500; font-size: 0.9rem;">Server</span>
                            <span class="status-value status-success" style="color: #00ff88; font-weight: 600; text-shadow: 0 0 8px rgba(0, 255, 136, 0.3);">‚úÖ OPERATIONAL</span>
                        </div>
                        <div class="status-line" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15); transition: all 0.3s ease;">
                            <span class="status-label" style="color: #aaa; font-weight: 500; font-size: 0.9rem;">Uptime</span>
                            <span class="status-value" style="color: #00ff88; font-weight: 600; text-shadow: 0 0 8px rgba(0, 255, 136, 0.3);" id="uptimeDisplay2">Loading...</span>
                        </div>
                        <div class="status-line" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15); transition: all 0.3s ease;">
                            <span class="status-label" style="color: #aaa; font-weight: 500; font-size: 0.9rem;">System Time</span>
                            <span class="status-value" style="color: #00ff88; font-weight: 600; text-shadow: 0 0 8px rgba(0, 255, 136, 0.3);" id="systemTime">${new Date().toLocaleTimeString()}</span>
                        </div>
                    `;
                } else {
                    console.error('‚ùå System status content element not found');
                }
            
                // Load statistics
                const statsContent = document.getElementById('statisticsContent');
                if (statsContent) {
                    console.log('‚úÖ Loading statistics panel');
                    statsContent.innerHTML = `
                        <div class="stat-item" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15); transition: all 0.3s ease;">
                            <span class="stat-label" style="color: #aaa; font-weight: 500; font-size: 0.9rem;">üìä Total Problems</span>
                            <span class="stat-value" style="color: #00ff88; font-weight: 600; text-shadow: 0 0 8px rgba(0, 255, 136, 0.3);">156</span>
                        </div>
                        <div class="stat-item" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15); transition: all 0.3s ease;">
                            <span class="stat-label" style="color: #aaa; font-weight: 500; font-size: 0.9rem;">üìù Total Submissions</span>
                            <span class="stat-value" style="color: #00ff88; font-weight: 600; text-shadow: 0 0 8px rgba(0, 255, 136, 0.3);">12,847</span>
                        </div>
                        <div class="stat-item" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15); transition: all 0.3s ease;">
                            <span class="stat-label" style="color: #aaa; font-weight: 500; font-size: 0.9rem;">üë• Active Users</span>
                            <span class="stat-value" style="color: #00ff88; font-weight: 600; text-shadow: 0 0 8px rgba(0, 255, 136, 0.3);">42</span>
                        </div>
                        <div class="stat-item" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15); transition: all 0.3s ease;">
                            <span class="stat-label" style="color: #aaa; font-weight: 500; font-size: 0.9rem;">‚ö° Success Rate</span>
                            <span class="stat-value" style="color: #00ff88; font-weight: 600; text-shadow: 0 0 8px rgba(0, 255, 136, 0.3);">68.5%</span>
                        </div>
                        <div class="stat-item" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15); transition: all 0.3s ease;">
                            <span class="stat-label" style="color: #aaa; font-weight: 500; font-size: 0.9rem;">üèÜ Top Language</span>
                            <span class="stat-value" style="color: #00ff88; font-weight: 600; text-shadow: 0 0 8px rgba(0, 255, 136, 0.3);">Python</span>
                        </div>
                    `;
                } else {
                    console.error('‚ùå Statistics content element not found');
                }
            
                // Load performance metrics
                const perfContent = document.getElementById('performanceContent');
                if (perfContent) {
                    console.log('‚úÖ Loading performance panel');
                    perfContent.innerHTML = `
                        <div class="metric-item" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15); transition: all 0.3s ease;">
                            <span class="metric-label" style="color: #aaa; font-weight: 500; font-size: 0.9rem;">‚ö° Response Time</span>
                            <span class="metric-value" style="color: #00ff88; font-weight: 600; text-shadow: 0 0 8px rgba(0, 255, 136, 0.3);" id="responseTime2">45ms</span>
                        </div>
                        <div class="metric-item" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15); transition: all 0.3s ease;">
                            <span class="metric-label" style="color: #aaa; font-weight: 500; font-size: 0.9rem;">üß† Memory Usage</span>
                            <span class="metric-value" style="color: #00ff88; font-weight: 600; text-shadow: 0 0 8px rgba(0, 255, 136, 0.3);" id="memoryUsage2">62%</span>
                        </div>
                        <div class="metric-item" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15); transition: all 0.3s ease;">
                            <span class="metric-label" style="color: #aaa; font-weight: 500; font-size: 0.9rem;">üî• CPU Usage</span>
                            <span class="metric-value" style="color: #00ff88; font-weight: 600; text-shadow: 0 0 8px rgba(0, 255, 136, 0.3);" id="cpuUsage2">28%</span>
                        </div>
                        <div class="metric-item" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15); transition: all 0.3s ease;">
                            <span class="metric-label" style="color: #aaa; font-weight: 500; font-size: 0.9rem;">üîó Active Connections</span>
                            <span class="metric-value" style="color: #00ff88; font-weight: 600; text-shadow: 0 0 8px rgba(0, 255, 136, 0.3);" id="connections2">34</span>
                        </div>
                        <div class="metric-item" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; padding: 0.75rem 0; border-bottom: 1px solid rgba(0, 255, 136, 0.15); transition: all 0.3s ease;">
                            <span class="metric-label" style="color: #aaa; font-weight: 500; font-size: 0.9rem;">üì° Network I/O</span>
                            <span class="metric-value" style="color: #00ff88; font-weight: 600; text-shadow: 0 0 8px rgba(0, 255, 136, 0.3);" id="networkIO">2.4 MB/s</span>
                        </div>
                    `;
                } else {
                    console.error('‚ùå Performance content element not found');
                }
                
                console.log('‚úÖ All system data loaded successfully');
                
            } catch (error) {
                console.error('‚ùå Error loading system data:', error);
            }
            }
        }
        
        // Setup command input functionality
        function setupCommandInput() {
            const commandInput = document.getElementById('commandInput');
            if (commandInput) {
                commandInput.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        const command = commandInput.value.trim();
                        if (command) {
                            processCommand(command);
                            commandInput.value = '';
                        }
                    }
                });
                
                // Focus the input
                commandInput.focus();
            }
        }
        
        // Process terminal commands
        function processCommand(command) {
            const output = document.getElementById('commandOutput');
            if (!output) return;
            
            // Add command to output
            const commandLine = document.createElement('div');
            commandLine.className = 'command-line';
            commandLine.style.marginBottom = '0.5rem';
            commandLine.style.display = 'flex';
            commandLine.style.alignItems = 'center';
            commandLine.innerHTML = `
                <span class="prompt" style="color: #ff6b35; margin-right: 0.5rem; font-weight: 600;">codexam@system:~$</span>
                <span class="command-text" style="color: #00ff88;">${command}</span>
            `;
            output.appendChild(commandLine);
            
            // Process command
            let response = '';
            switch (command.toLowerCase()) {
                case 'help':
                    response = `Available commands:
  help     - Show this help message
  status   - Show system status
  stats    - Show platform statistics
  time     - Show current system time
  uptime   - Show system uptime
  clear    - Clear terminal output
  users    - Show active users
  problems - Show problem statistics`;
                    break;
                case 'status':
                    response = `=== SYSTEM STATUS ===
Server: OPERATIONAL
Database: CONNECTED
Judge Engine: ONLINE
Uptime: ${Math.floor(Math.random() * 72) + 1}h ${Math.floor(Math.random() * 60)}m`;
                    break;
                case 'stats':
                    response = `=== PLATFORM STATISTICS ===
Total Problems: 156
Total Submissions: 12,847
Active Users: 42
Success Rate: 68.5%`;
                    break;
                case 'time':
                    response = `Current time: ${new Date().toLocaleString()}`;
                    break;
                case 'uptime':
                    response = `System uptime: ${Math.floor(Math.random() * 72) + 1}h ${Math.floor(Math.random() * 60)}m`;
                    break;
                case 'clear':
                    output.innerHTML = `
                        <div class="command-line" style="margin-bottom: 0.5rem; display: flex; align-items: center;">
                            <span class="prompt" style="color: #ff6b35; margin-right: 0.5rem; font-weight: 600;">codexam@system:~$</span>
                            <span class="command-text" style="color: #00ff88;">Terminal cleared</span>
                        </div>
                    `;
                    output.scrollTop = output.scrollHeight;
                    return;
                case 'users':
                    response = `=== ACTIVE USERS ===
Total registered: 1,247
Currently online: 42
Peak today: 89`;
                    break;
                case 'problems':
                    response = `=== PROBLEM STATISTICS ===
Easy: 62 problems
Medium: 71 problems  
Hard: 23 problems
Most popular: Two Sum`;
                    break;
                default:
                    response = `Command not found: ${command}
Type 'help' for available commands`;
            }
            
            // Add response
            const responseLine = document.createElement('div');
            responseLine.className = 'command-line';
            responseLine.style.marginBottom = '0.5rem';
            responseLine.style.whiteSpace = 'pre-line';
            responseLine.innerHTML = `<span class="command-text" style="color: #00ff88;">${response}</span>`;
            output.appendChild(responseLine);
            
            // Scroll to bottom
            output.scrollTop = output.scrollHeight;
        }
        
        // Initialize and test when DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ DOM loaded - checking modal setup...');
            
            // Check if modal exists
            const modal = document.getElementById('systemInfoModal');
            console.log('Modal element found:', !!modal);
            
            // Check if button exists
            const button = document.querySelector('.system-info-btn');
            console.log('System info button found:', !!button);
            
            // Check if functions exist
            console.log('showSystemInfoModal function:', typeof window.showSystemInfoModal);
            console.log('hideSystemInfoModal function:', typeof window.hideSystemInfoModal);
            
            if (modal && button) {
                console.log('‚úÖ All elements found - modal should work!');
                console.log('üí° Try clicking the "System Info" button');
                console.log('üí° Modal will show system information with live metrics');
                console.log('üí° If modal glitches, call fixSystemInfoModal() or add #skipboot to URL');
                
                // Initial metrics update
                updateSystemMetrics();
            } else {
                console.error('‚ùå Missing elements - modal will not work');
            }
        });
        
        // Test if SystemInfoModal is available
        window.testSystemInfoModal = function() {
            console.log('üîß Testing System Info Modal...');
            console.log('üîß SystemInfoModal exists:', typeof window.SystemInfoModal);
            console.log('üîß Modal element exists:', !!document.getElementById('systemInfoModal'));
            
            if (window.SystemInfoModal) {
                console.log('‚úÖ SystemInfoModal object found');
                console.log('üîß Modal state:', {
                    isOpen: window.SystemInfoModal.isOpen,
                    isAnimating: window.SystemInfoModal.isAnimating
                });
                
                try {
                    window.SystemInfoModal.show();
                    console.log('‚úÖ Modal show() called successfully');
                } catch (error) {
                    console.error('‚ùå Error calling modal show():', error);
                    console.log('üîß Falling back to testModalShow()');
                    testModalShow();
                }
            } else {
                console.error('‚ùå SystemInfoModal object not found');
                console.log('üîß Falling back to testModalShow()');
                testModalShow();
            }
        };
        
        // Simple test function to check modal visibility
        window.testModalShow = function() {
            console.log('üîß testModalShow() called');
            const modal = document.getElementById('systemInfoModal');
            if (modal) {
                console.log('‚úÖ Modal found, current display:', modal.style.display);
                modal.style.display = 'flex';
                modal.style.visibility = 'visible';
                modal.style.opacity = '1';
                modal.classList.add('show');
                document.body.style.overflow = 'hidden';
                console.log('‚úÖ Modal should now be visible');
                return true;
            } else {
                console.error('‚ùå Modal element not found');
                return false;
            }
        };
        
        // Simple hide function
        window.testModalHide = function() {
            const modal = document.getElementById('systemInfoModal');
            if (modal) {
                modal.style.display = 'none';
                modal.style.visibility = 'hidden';
                modal.style.opacity = '0';
                modal.classList.remove('show');
                document.body.style.overflow = '';
                console.log('Modal hidden');
            }
        };
    </script>
    <script>
        // Cyber theme enhancements
        document.addEventListener('DOMContentLoaded', function() {
            // Add glow effect to active elements
            const activeElements = document.querySelectorAll('.nav-link.active');
            activeElements.forEach(el => {
                el.classList.add('animate-glow');
            });
            
            // Terminal-style typing effect for status messages
            const statusElements = document.querySelectorAll('.animate-pulse');
            statusElements.forEach(el => {
                setInterval(() => {
                    el.style.opacity = el.style.opacity === '0.5' ? '1' : '0.5';
                }, 1000);
            });
            
            // Mobile menu toggle animation
            const navToggle = document.querySelector('.navbar-toggle');
            if (navToggle) {
                navToggle.addEventListener('click', function() {
                    this.classList.toggle('active');
                });
            }
            
            // Sticky header scroll effect
            const navbar = document.querySelector('.cyber-navbar');
            if (navbar) {
                let lastScrollY = window.scrollY;
                
                window.addEventListener('scroll', function() {
                    const currentScrollY = window.scrollY;
                    
                    if (currentScrollY > 50) {
                        navbar.classList.add('scrolled');
                    } else {
                        navbar.classList.remove('scrolled');
                    }
                    
                    lastScrollY = currentScrollY;
                });
                
            }
            
            // Auto-dismiss alerts after 5 seconds
            const alerts = document.querySelectorAll('.alert');
            alerts.forEach(alert => {
                setTimeout(() => {
                    const bsAlert = new bootstrap.Alert(alert);
                    bsAlert.close();
                }, 5000);
            });
        });
        
        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            // Ctrl/Cmd + K to focus search (if available)
            if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                e.preventDefault();
                const searchInput = document.querySelector('input[type="search"]');
                if (searchInput) {
                    searchInput.focus();
                }
            }
            
            // Escape to close modals
            if (e.key === 'Escape') {
                const openModals = document.querySelectorAll('.modal.show');
                openModals.forEach(modal => {
                    const bsModal = bootstrap.Modal.getInstance(modal);
                    if (bsModal) {
                        bsModal.hide();
                    }
                });
            }
        });
    </script>
    
    {% block extra_js %}{% endblock %}
</body>
</html>

<style>
/* Additional styles for base template */
.cyber-footer {
    background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-primary) 100%);
    border-top: 1px solid var(--border-primary);
    padding: var(--space-8) 0 var(--space-6) 0;
    margin-top: auto;
}

.footer-content {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: var(--space-4);
}

.footer-brand {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    font-family: var(--font-mono);
    font-weight: var(--font-weight-bold);
    color: var(--text-primary);
}

.footer-brand .brand-icon {
    color: var(--accent-primary);
    text-shadow: 0 0 10px var(--accent-glow);
}

.footer-links {
    display: flex;
    gap: var(--space-4);
}

.footer-links a {
    color: var(--text-secondary);
    text-decoration: none;
    transition: var(--transition-fast);
    font-size: var(--text-sm);
}

.footer-links a:hover {
    color: var(--accent-primary);
    text-shadow: 0 0 8px var(--accent-glow);
}

.footer-info {
    text-align: right;
    font-size: var(--text-sm);
}

.footer-info p {
    margin-bottom: 0.25rem;
}

/* Mobile hamburger menu */
.navbar-toggle {
    display: flex;
    flex-direction: column;
    gap: 4px;
    background: transparent;
    border: none;
    padding: var(--space-2);
    cursor: pointer;
}

.hamburger-line {
    width: 24px;
    height: 2px;
    background: var(--accent-primary);
    transition: var(--transition-normal);
    border-radius: 2px;
}

.navbar-toggle.active .hamburger-line:nth-child(1) {
    transform: rotate(45deg) translate(6px, 6px);
}

.navbar-toggle.active .hamburger-line:nth-child(2) {
    opacity: 0;
}

.navbar-toggle.active .hamburger-line:nth-child(3) {
    transform: rotate(-45deg) translate(6px, -6px);
}

/* Modal customizations */
.modal-content {
    background: var(--bg-secondary);
    border: 1px solid var(--border-primary);
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
}

.modal-header {
    background: var(--bg-tertiary);
}

.form-control {
    background: var(--bg-tertiary);
    border: 1px solid var(--border-primary);
    color: var(--text-primary);
}

.form-control:focus {
    background: var(--bg-tertiary);
    border-color: var(--accent-primary);
    box-shadow: 0 0 10px var(--accent-glow);
    color: var(--text-primary);
}

.form-label {
    color: var(--text-primary);
    font-weight: var(--font-weight-medium);
}

.form-text {
    color: var(--text-muted);
}

.form-check-input:checked {
    background-color: var(--accent-primary);
    border-color: var(--accent-primary);
}

/* Alert customizations */
.alert {
    background: var(--bg-secondary);
    border: 1px solid var(--border-primary);
    color: var(--text-primary);
}

.alert-success {
    background: var(--status-success-bg);
    border-color: var(--status-success-border);
    color: var(--status-success);
}

.alert-danger {
    background: var(--status-error-bg);
    border-color: var(--status-error-border);
    color: var(--status-error);
}

.alert-warning {
    background: var(--status-warning-bg);
    border-color: var(--status-warning-border);
    color: var(--status-warning);
}

.alert-info {
    background: var(--status-info-bg);
    border-color: var(--status-info-border);
    color: var(--status-info);
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .navbar-nav {
        position: fixed;
        top: 100%;
        left: 0;
        right: 0;
        background: var(--bg-secondary);
        border-top: 1px solid var(--border-primary);
        padding: var(--space-4);
        transform: translateY(-100%);
        transition: var(--transition-normal);
        z-index: 999;
        flex-direction: column;
        gap: var(--space-2);
    }
    
    .navbar-nav.show {
        transform: translateY(0);
    }
    
    .footer-content {
        flex-direction: column;
        text-align: center;
        gap: var(--space-6);
    }
    
    .footer-info {
        text-align: center;
    }
    
    .footer-links {
        justify-content: center;
    }
}
</style>